% !TeX spellcheck = ru-RU
\documentclass[../main.tex]{subfiles}
\begin{document}
\clearpage
\section{Множества достижимости нелинейных систем с интегральными ограничениями}
\label{s1}
Первая глава посвящена исследованию свойств множеств достижимости нелинейных систем с интегральными ограничениями и малым параметром.
В первом разделе исследуются решения нелинейных систем с интегральными ограничениями.
Здесь описаны основные предположения, которые распространяются на всю работу.
В условиях этих предположений доказываются некоторые важные свойства решений нелинейных управляемых систем, которые будут использоваться далее. 
 
Второй раздел посвящён выпуклости множеств достижимости.
Он начинается с описания известного результата об условии выпуклости нелинейного отображения малого шара в гильбертовом пространстве, полученного Б.\,Т.~Поляком\cite{Polyak2001, Polyak2001ru}.
Затем это условие применяется для обоснования выпуклости множеств достижимости нелинейных систем при интегральных ограничениях на управление.
Приведены две постановки, в первой из которых ограничения на управление заданы шаром достаточно малого радиуса \cite{Polyak2004}, а во второй постановке ограничения на управление не обязательно малы, но вся задача рассматривается на малом промежутке времени \cite{GusevMotor, GusevOsipovTrudy}.
Наконец, в третьем разделе приведён один из возможных методов проверки условий, при которых множества достижимости нелинейных систем с интегральными ограничениями оказываются выпуклыми на малых интервалах времени. 
 
 
\subsection{Некоторые свойства решений нелинейных систем с интегральными ограничениями}
На интервале времени $ t_0 \leqslant t \leqslant \overline{T} $ рассмотрим нелинейную систему, аффинную по управлению
\begin{gather}\label{s1:common_nonlinear}
\begin{gathered}
 \dot{x}(t)=f_1\big(t,x(t)\big)+f_2\big(t,x(t)\big)u(t), \qquad x(t_0) = x_0.
\end{gathered}
\end{gather}
Здесь $ x \in \mathbb{R}^n $ ~--- вектор состояния, $ u \in \mathbb{R}^r $~--- управление, $t_0$, $ \overline{T} $ ~--- некоторые фиксированные положительные числа.
 
Функции $ f_1: [t_0, \overline{T}] \times \mathbb{R}^n \rightarrow \mathbb{R}^{n} $, $ f_2: [t_0, \overline{T}] \times \mathbb{R}^n \rightarrow \mathbb{R}^{n \times r} $ предполагаются непрерывными по $(t,x)$ и обладающими непрерывными производными по $ x $ на $ [t_0, \overline{T}] \times \Omega $, где $\Omega$~--- некоторая область, $\Omega \subset \mathbb{R}^n$. 

Всюду далее будем считать, что точка $x_0$ фиксирована и $x_0 \in \Omega $. 
 
Каждому управлению $ u(\cdot) \in \mathbb{L}_2[t_0, \overline{T}] $ соответствует единственное абсолютно непрерывное решение (траектория) $ x(t)=x(t,u(\cdot)) $ системы \eqref{s1:common_nonlinear}, удовлетворяющее условию $ x(t_0, u(\cdot)) = x_0$ и определённое на интервале $ [t_0, t_0 + \Delta] $, $\Delta > 0$, $ t_0 + \Delta < \overline{T}$.
Здесь и далее, через $\mathbb{L}_2[t_0, \overline{T}] $ обозначено пространство интегрируемых с квадратом функций на интервале $[t_0, \overline{T}]$. 

\begin{assumption}\label{s1:as:right_hand_side_conditions_global}
 Существует такое $\overline{\mu} > 0 $, что все решения (траектории) $ x(t, u(\cdot)) $ системы \eqref{s1:common_nonlinear}, отвечающие управлениям $u(\cdot) \in B_{\mathbb{L}_2[t_0, \overline{T}]}(0,\overline{\mu})$, определены на интервале $ [t_0,\overline{T}] $ и лежат в некотором выпуклом компакте $D \subset \Omega \subset \mathbb{R}^n$. 
\end{assumption}
 
Заметим, что из Предположения \ref{s1:as:right_hand_side_conditions_global} следует, что $x_0 \in D$. 
Будем считать, что $x_0 \in \operatorname{int} D$, где $\operatorname{int} D $~--- множество внутренних точек $D$.

В частности, Предположение \ref{s1:as:right_hand_side_conditions_global} выполняется, если функции $f_1$ и $f_2$ удовлетворяют в $ [t_0, \overline{T}] \times \mathbb{R}^n$ условиям
\begin{gather}\label{s1:right_hand_side_condition}
 \left\|f_1\big(t, x\big) \right\| \leqslant l_1(t) (1 + \|x\|), \qquad \left\| f_2(t,x) \right\| \leqslant l_2(t), 
\end{gather}
где $ l_1(\cdot) \in \mathbb{L}_1[t_0, \overline{T}] $, $ l_2(\cdot) \in \mathbb{L}_2[t_0, \overline{T}]$.
В \cite[Теорема 5]{Filippov2} доказано, что из условия \eqref{s1:right_hand_side_condition} следует продолжимость траекторий. 
При этом же условии можно доказать, что множество траекторий компактно в $\mathbb{C}[t_0, \overline{T}]$ (см., например, \cite{GusZyk, Guseinov2022}).
 
Известны также другие оценки на правую часть системы, при наличии которых справедливо Предположение \ref{s1:as:right_hand_side_conditions_global} (см., например, \cite{Filippov2, Guseinov2010}).
 
В дальнейшем, управление $ u(\cdot) $ будем выбирать из шара $ B_{\mathbb{L}_2[t_0, \overline{T}]}(0,\mu) $, где $ 0 < \mu \leqslant \overline{\mu} $.
 
\begin{lemma}\label{s1:lem:lip_of_solutions_global}
 Пусть выполнено Предположение \ref{s1:as:right_hand_side_conditions_global}.
 Тогда найдётся такое $L_x > 0$, что для любых $u_i(\cdot) \in B_{\mathbb{L}_2[t_0, \overline{T}]}(0,\mu) $, $i = 1,2$, и $t \in [t_0, \overline{T}]$
 \begin{gather*}
 \left\| x_1(t) - x_2(t) \right\| \leqslant L_x \left\|u_1(\cdot) - u_2(\cdot) \right\|_{\mathbb{L}_2[t_0, \overline{T}]}, 
 \end{gather*}
 где $x_i(t) = x_i(t,u_i(\cdot))$, $i = 1,2$. 
\end{lemma}
\doc
Из интегрального соотношения
\begin{gather*}
 x_i(t) = x_0 
 + \int\limits_{t_0}^{t} f_1(\tau, x_i(\tau))\ d\tau 
 + \int\limits_{t_0}^{t} f_2(\tau,x_i(\tau))u_i(\tau)\ d\tau 
 = \\ = 
 x_0 
 + \int\limits_{t_0}^{t} f_1(\tau, x_i(\tau))\ d\tau 
 + \int\limits_{t_0}^{t} 
 \sum\limits_{k = 1}^{r} 
 f_2^k(\tau,x_i(\tau))u_i^k(\tau)\ d\tau,
\end{gather*}
где $f_2^k$ --- $k$-ый столбец матричнозначной функции $f_2$, а $u^k(t)$ --- $k$-ый компонент вектора управления $u(t)$, имеем 
\begin{gather}\label{s1:diff_of_solution}
\begin{gathered}
 \| x_1(t) - x_2(t) \| 
 \leqslant 
 \left\| 
 \int\limits_{t_0}^{t} \Big( f_1(\tau, x_1(\tau)) - f_1(\tau, x_2(\tau)) \Big) \ d\tau 
 \right.
 + \\ + 
 \left.
 \int\limits_{t_0}^{t} 
 \sum\limits_{k = 1}^{r}
 \Big( f_2^k(\tau, x_1(\tau)) - f_2^k(\tau, x_2(\tau)) \Big) u_2^k(\tau) \ d\tau 
 \right\| 
 + \\ +
 \left\| 
 \int\limits_{t_0}^{t} 
 \sum\limits_{k = 1}^{r}
 f_2^k(\tau,x_1(\tau)) \big( u_1^k(\tau) - u_2^k(\tau) \big) \ d\tau 
 \right\|. 
\end{gathered}
\end{gather}

Оценим приращение $f_1$ через интеграл по параметру:
\begin{gather}\label{s1:meanvalue_f1}
		f_1(\tau, x_1(\tau)) - f_1(\tau, x_2(\tau)) = \left( \int\limits_0^1 \frac{\partial f_1}{\partial x} \Big(\tau, x_2(\tau) + \xi \big(x_2(\tau) - x_1(\tau)\big)\Big) \ d\xi \right) \big(x_1(\tau) - x_2(\tau)\big).
\end{gather}

Так как для $0 \leqslant \xi \leqslant 1 $ и $\tau \in [t_0,\overline{T}]$ выполняется включение $x_2(\tau) + \xi \big(x_2(\tau) - x_1(\tau)\big) \in D$, то из Предположения \ref{s1:as:right_hand_side_conditions_global}, учитывая непрерывность $\dfrac{\partial f_1}{\partial x} $, а также компактность множества $D$, мы имеем, что 
\begin{gather}\label{s1:lip_f1}
		\big\| f_1(\tau, x_1(\tau)) - f_1(\tau, x_2(\tau)) \big\| \leqslant L_{f_1} \|x_1(\tau) - x_2(\tau)\|,
\end{gather}
где $L_{f_1} = \max\limits_{(\tau, x ) \in [t_0, \overline{T}] \times D} \left\| \dfrac{\partial f_1}{\partial x} (\tau, x) \right\| $.

Аналогичное представление приращений столбцов матричнозначной функции $f_2^k$ имеет вид
\begin{gather}\label{s1:meanvalue_f2}
 f_2^k(\tau, x_1(\tau)) 
 - 
 f_2^k(\tau, x_2(\tau)) 
 = \left(
 \int\limits_0^1 
 \frac{\partial f_2^k}{\partial x} \Big(\tau, x_2(\tau) + \xi \big(x_2(\tau) - x_1(\tau)\big)\Big) 
 \ d\xi \right) 
 \big(x_1(\tau) - x_2(\tau)\big).
\end{gather}
Здесь $\dfrac{\partial f_2^k}{\partial x}: [t_0, \overline{T}] \times \mathbb{R}^n \rightarrow \mathbb{R}^{n \times n} $ --- это матрица частных производных (якобиан) $k$-ого столбца функции $f_2$. 
Тогда, в силу компактности $[t_0, \overline{T}] \times D$, существуют константы 
\begin{gather*}
	L_{f_2^k} = \max\limits_{(\tau, x ) \in [t_0, \overline{T}] \times D} \left\| \dfrac{\partial f_2^k}{\partial x} (\tau, x) \right\|.
\end{gather*}
 
Следовательно, 
\begin{gather}\label{s1:lip_f2}
	\begin{gathered}
	\left\|
	 \sum\limits_{k = 1}^{r}
	\Big( f_2^k(\tau, x_1(\tau)) - f_2^k(\tau, x_2(\tau)) \Big) u_2^k(\tau) \ d\tau 
	\right\| 
	\leqslant
	\left\|
	x_1(\tau) - x_2(\tau)
	\right\|
	 \sum\limits_{k = 1}^{r} 
	 L_{f_2^k}
	 \left|
	 u_2^k(\tau)
	 \right|
	 \leqslant \\ \leqslant 
	 \sqrt{\sum_{k=1}^r L_{f_2^k}^2} \cdot
	 \left\|
	 x_1(\tau) - x_2(\tau)
	 \right\| 
	 \| u_2(\tau) \|.
	 \end{gathered}
\end{gather}
 
Используя полученные соотношения \eqref{s1:lip_f1}, \eqref{s1:lip_f2}, в \eqref{s1:diff_of_solution} получаем
\begin{gather*}
 \| x_1(t) - x_2(t) \| \leqslant \int\limits_{t_0}^{t} (L_{f_1} + L_{f_2} \| u_2(\tau)\|) \|x_1(\tau) - x_2(\tau)\| \ d\tau + k_{f_2} \sqrt{\overline{T} - t_0} \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2[t_0, \overline{T}]},
\end{gather*}
где 
\begin{gather*}
	k_{f_2} = \max\limits_{(\tau,\, x ) \in [t_0, \overline{T}] \times D} \| f_2 (\tau, x) \|, \qquad
	L_{f_2} = \sqrt{\sum_{k=1}^r L_{f_2^k}^2}.
\end{gather*}
Из леммы Гронуолла — Беллмана \cite[Лемма 1]{Bellman1943} следует неравенство
\begin{gather}\label{s1:lip_of_solution}
 \left\| x_1(t) - x_2(t) \right\| \leqslant L_x \left\|u_1(\cdot) - u_2(\cdot) \right\|_{\mathbb{L}_2[t_0, \overline{T}]}, 
\end{gather}
где $L_x = k_{f_2} \sqrt{\overline{T} - t_0} \exp\big(L_{f_1}(\overline{T} - t_0) + L_{f_2} \mu\sqrt{\overline{T} - t_0}\big)$.
\hfill $\square$
\begin{zam}
Константа Липшица $L_x$ в Лемме \ref{s1:lem:lip_of_solutions_global} выбрана не зависящей от $t$.
Таким образом, неравенство \eqref{s1:lip_of_solution} выполняется для всех $t_0 \leqslant t \leqslant \overline{T}$.
То есть, справедливо 
\begin{gather*}
 \left\| x_1(\cdot) - x_2(\cdot) \right\|_{\mathbb{C}[t_0, \overline{T}]} \leqslant L_x \left\|u_1(\cdot) - u_2(\cdot) \right\|_{\mathbb{L}_2[t_0, \overline{T}]}.
\end{gather*}
\end{zam}
 
Пусть $ 0 < T \leqslant \overline{T} $. 
Рассмотрим сужения управлений $u(\cdot) \in \mathbb{L}_2[t_0, \overline{T}]$ на интервал $[t_0, T]$.
Заметим, что если $u(\cdot) \in B_{\mathbb{L}_2[t_0, \overline{T}]}(0,\mu) $, то его сужение на интервал $[t_0, T]$ будет принадлежать $ B_{\mathbb{L}_2[t_0, T]}(0,\mu) $. 
Для сужений управлений на интервал $[t_0, T]$ сохраним обозначение $u(\cdot) $.
Так как везде далее в этом разделе будет рассматриваться интервал $[t_0, T]$, то для краткости будем опускать интервал в определении пространства, считая, что $\mathbb{L}_2[t_0, T] = \mathbb{L}_2$.

Дополнительно заметим, что свойства системы \eqref{s1:common_nonlinear}, такие как непрерывность функций $f_1$, $f_2$ и их производных, а также единственность решений и ограниченность множества решений (Предположение \ref{s1:as:right_hand_side_conditions_global}), которые предполагались справедливыми на интервале $[t_0, \overline{T}]$, будут справедливы и на интервале $[t_0, T]$.

\begin{definition}\label{s1:def:linearized_system}
 Пусть $ x(\cdot,u(\cdot)) $ ~--- движение, отвечающее управлению $ u(\cdot)$.
 Назовём систему
 \begin{gather}\label{s1:linearized_system}
 \delta \dot{x} = A(t) \delta x + B(t) \delta u, \qquad t_0 \leqslant t \leqslant T, \qquad \delta x(t_0) = 0,
 \end{gather}
 линеаризацией системы \eqref{s1:common_nonlinear} вдоль пары траектории и управления $\left( x(\cdot,u(\cdot)),u(\cdot)\right) $, если 
 \begin{gather*}
 A(t) = \dfrac{\partial f_1}{\partial x} \Big(t,x\big(t,u(\cdot)\big)\Big) 
 + 
 \sum\limits_{k = 1}^{r}
 \dfrac{\partial f_2^k}{\partial x}\Big(t,x\big(t,u(\cdot)\big)\Big) u^k(t), \ 
 B(t) = f_2 \Big(t,x\big(t,u(\cdot)\big)\Big).
 \end{gather*}
 Здесь $ A(\cdot) $ представляет собой матрицу Якоби функции $ f_1(\cdot, x) + f_2(\cdot, x) u(\cdot) $, вычисленную вдоль траектории $ x(\cdot,u(\cdot)) $.
\end{definition}

Решение системы \eqref{s1:linearized_system} имеет вид 
\begin{gather*}
\delta x(t) = \int\limits_{t_0}^{t} X(t, \tau) B(\tau) \delta u(\tau) \ d\tau 
\end{gather*}
 где $ X(\tau_1,\tau_0)= \Phi(\tau_1) \Phi^{-1}(\tau_0) $, $\Phi(t) $ ~--- фундаментальная матрица решений однородной системы, удовлетворяющая уравнению 
\begin{gather}\label{s1:fundumental_matrix_eq}
 \dot{\Phi}(t) = A(t) \Phi(t), \qquad \Phi(t_0) = I.
\end{gather}

Так как $A(t)$ измерима, то решение \eqref{s1:fundumental_matrix_eq} определено в некоторой окрестности $t_0$ и единственно\cite[с. 46]{Filippov2}. 
Докажем, что решение может быть продолжено на интервале $[t_0, T]$. 
Для каждого фиксированного $u(\cdot) $ найдётся такое $\tau > t_0$, что решение \eqref{s1:fundumental_matrix_eq} определено на интервале $ [t_0, \tau] $.
Выберем наибольшее из таких $\tau$.
Предположим, что $\tau < T$. 
Тогда проинтегрируем \eqref{s1:fundumental_matrix_eq} от $t_0$ до $\tau$, получив
\begin{gather*}
 \Phi(\tau) = I + \int\limits_{t_0}^{\tau} A(s) \Phi(s) \ ds.
\end{gather*}

Заметим, что $A(s)$ --- интегрируема, а $ \Phi(s)$ --- ограничена при $s \in [t_0, \tau]$, поэтому интеграл конечен и

\begin{gather*}
 \| \Phi(\tau) \| \leqslant 1 + \int\limits_{t_0}^{\tau} \| A(s)\| \|\Phi(s)\| \ ds.
\end{gather*}

Из Леммы Гронуолла--Беллмана следует, что $ \| \Phi(\tau) \| \leqslant \exp \left( \int_{t_0}^{\tau} \| A(s)\| \ ds \right)$, а значит $\Phi(\cdot)$ может быть продолжено при $t > \tau$. 
Получаем противоречие.

Заметим, что интеграл $\int_0^t \| A(\tau)\| \ d\tau$ равномерно ограничен по $u(\cdot) $ на $ B_{\mathbb{L}_2}(0,\mu)$.
Таким образом, можно заключить, что при всех $u(\cdot) \in B_{\mathbb{L}_2}(0,\mu)$, существует ограниченное решение \eqref{s1:fundumental_matrix_eq}, определённое на интервале $[t_0, T]$.

В Определении \ref{s1:def:linearized_system} матрицы $A$ и $B$ зависят от управления $u$. 
Очевидно, что матрица $X(\cdot, \cdot)$ также зависит от этого управления $u$.
В случае, где эта зависимость важна, будем использовать обозначения $A(\cdot, u(\cdot))$, $B(\cdot, u(\cdot))$, $X(\cdot, \cdot, u(\cdot))$. 
 
 
Напомним, что начальное условие $x_0 $ зафиксировано, а $ x(\cdot,u(\cdot))$ ~--- решение системы \eqref{s1:common_nonlinear}, порождённое управлением $u(\cdot)$ и удовлетворяющее условию $x(t_0, u(\cdot)) = x_0$. 
Введём отображение $F: \mathbb{L}_2 \rightarrow \mathbb{R}^n $ равенством 
\begin{gather}\label{s1:solution_endpoint_mapping}
 F(u(\cdot)) = x(T,u(\cdot)), \qquad 0 \leqslant T \leqslant \overline{T}.
\end{gather} 
 
\begin{lemma}\label{s1:lem:frechet_derivative_common}
 Пусть выполнено Предположение \ref{s1:as:right_hand_side_conditions_global}.
 Тогда отображение $F$ имеет непрерывную производную Фреше, определяемую равенством $ F'(u(\cdot))\delta u(\cdot) =\delta x(T)$, где $\delta x(T)$ ~--- решение линеаризованной вдоль пары $\left( x(t,u(\cdot)),u(\cdot)\right) $ системы \eqref{s1:linearized_system}, порождённое управлением $\delta u(\cdot)$ при нулевом начальном условии.
\end{lemma}
\doc 
Выберем произвольные $u(\cdot)$, $\Delta u(\cdot)$ так, что $ u(\cdot) \in B_{\mathbb{L}_2}(0,\mu)$ и $ u(\cdot) + \Delta u(\cdot) \in B_{\mathbb{L}_2}(0,\mu)$.
Решения системы \eqref{s1:common_nonlinear}, порождённые управлениями $u(\cdot)$ и \mbox{$u(\cdot) + \Delta u(\cdot)$}, обозначим через $x(\cdot) = x(\cdot,u(\cdot))$ и $ x(\cdot) + \Delta x(\cdot) = x(\cdot, u(\cdot) + \Delta u(\cdot))$.
По аналогии с \eqref{s1:diff_of_solution} получаем
\begin{gather}\label{s1:delta_x}
	\begin{gathered}
		\Delta \dot{x}(t) =
		\Big( f_1\big(t, x(t)+\Delta x(t)\big) - f_1\big(t, x(t)\big) \Big) + \\ +
		\sum\limits_{k=1}^r \Big( f_2^k\big(t, x(t)+\Delta x(t)\big) - f_2^k\big(t,x(t)\big) \Big) u^k(t) + \\ +
		\sum\limits_{k=1}^r f_2^k\big(t, x(t)+\Delta x(t)\big) \Delta u^k(t) .
	\end{gathered}
\end{gather}
Применяя формулы \eqref{s1:meanvalue_f1}, \eqref{s1:meanvalue_f2}, запишем 
\begin{gather*}
	\begin{gathered}
		 f_1(t, x(t)+\Delta x(t)) - f_1(t, x(t)) = \left( \int\limits_0^1 \frac{\partial f_1}{\partial x} \Big(t, x(t) + \xi \Delta x(t)\Big) \ d\xi \right) \Delta x(t) = \\ = \frac{\partial f_1}{\partial x} \Big(t, x(t)\Big) \Delta x(t) + \alpha\Big(x(t),\Delta x(t), t\Big) \Delta x(t), \\ 
		f_2^k(t, x(t)+\Delta x(t)) - f_2^k(t, x(t)) = \left( \int\limits_0^1 \frac{\partial f_2^k}{\partial x} \Big(t, x(t) + \xi \Delta x(t)\Big) d\xi \right) \Delta x(t) = \\
		= \frac{\partial f_2^k}{\partial x} \Big(t, x(t)\Big) \Delta x(t) + \beta^k\Big(x(t),\Delta x(t), t\Big) \Delta x(t),
	\end{gathered}
\end{gather*}
где
\begin{gather*}
	\alpha\Big(x(t),\Delta x(t), t\Big) = 
	\int\limits_0^1 \left[ \frac{\partial f_1}{\partial x} \Big(t, x(t) + \xi \Delta x(t)\Big) - \frac{\partial f_1}{\partial x} \Big(t, x(t)\Big) \right] \ d\xi,\\
	\beta^k\Big(x(t),\Delta x(t), t\Big) = \int\limits_0^1 \left[ \frac{\partial f_2^k}{\partial x} \Big(t, x(t) + \xi \Delta x(t)\Big) - \frac{\partial f_2^k}{\partial x} \Big(t, x(t)\Big) \right] d\xi.
\end{gather*}
Перепишем \eqref{s1:delta_x}
\begin{gather*}
	\Delta \dot{x}(t) =
	A(t) \Delta x(t) +
	B(t) \Delta u(t) +
	\omega(t),
\end{gather*}
где $A(t)$ и $B(t)$ соответствуют таковым в \eqref{s1:linearized_system}:
\begin{align*}
	A(t) &= \frac{\partial f_1}{\partial x}(t,x(t)) + \sum\limits_{k=1}^r \frac{\partial f_2^k}{\partial x}(t,x(t)) u^k(t), \\
	B(t) &= f_2(t,x(t)),
\end{align*}
а $\omega(t)$ определено равенством:
\begin{gather*}
		\omega(t) = 
		\alpha\Big(x(t),\Delta x(t), t\Big)\Delta x(t) 
		+
		\sum\limits_{k=1}^r 
		\beta^k\Big(x(t),\Delta x(t), t\Big)\Delta x(t) u^k(t) 
		+ \\ + 
		\sum\limits_{k=1}^r 
		\left(
		 \frac{\partial f_2^k}{\partial x}(t,x(t)) + \beta^k\Big(x(t),\Delta x(t), t\Big)
		\right) 
		\Delta x(t) \Delta u^k(t).
\end{gather*}
Из Леммы \ref{s1:lem:lip_of_solutions_global} следует, что при $\|\Delta u(\cdot)\|_{\mathbb{L}_2} \to 0$, $\|\Delta x(t)\| \to 0$ равномерно при всех $t_0 \leqslant t \leqslant T$.
Заметим, что если $\|\Delta x(t)\| \to 0$, то $ \left\| \alpha(x(t),\Delta x(t), t) \right\| \to 0 $ и $ \left\| \beta^k(x(t)),\Delta x(t), t) \right\| \to 0 $ также равномерно для всех $ t_0 \leqslant t \leqslant T $ .
Это следует из равномерной непрерывности производных $\frac{\partial f_1}{\partial x}$, $\frac{\partial f_2^k}{\partial x}$ на компакте $[t_0, \overline{T}] \times D$.
Таким образом, получаем:
\begin{gather*}
	\|\omega(t)\| \leqslant \left( \gamma_1 + \gamma_2 \|u(t)\| + \gamma_3 \|\Delta u(t)\| \right) \|\Delta x(t)\|,
\end{gather*}
где $\gamma_i > 0 $ и $\gamma_i \to 0 $ при $ \|\Delta u(\cdot)\|_{\mathbb{L}_2} ​\to 0$.
Тогда, равномерно по $t$,
\begin{gather}\label{s1:lim_omega}
	\lim\limits_{\|\Delta u(\cdot) \|_{\mathbb{L}_2} \to 0} \frac{ \| \omega(t) \| }{\|\Delta u(\cdot) \|_{\mathbb{L}_2}} = 0, \qquad t_0 \leqslant t \leqslant T .
\end{gather}
По формуле Коши получаем равенство
\begin{gather}\label{s1:increment_x}
	\Delta x(T) = \int\limits_{t_0}^{T} X(T, \tau) B(\tau) \Delta u(\tau) \ d\tau + \int\limits_{t_0}^{T} X(T, \tau) \omega(t) \ d\tau,
\end{gather}
где первое слагаемое является решением линеаризованной системы \eqref{s1:linearized_system}.
Так как $X(T, \tau) $ является решением уравнения $\frac{\partial X(T, \tau) }{\partial \tau} = -A(\tau)X(T, \tau)$, $X(\tau, \tau) = I$, то по аналогии с \eqref{s1:fundumental_matrix_eq} получаем, что существует $k_X > 0$, такое что $\|X(T, \tau) \| \leqslant k_X$, $t_0 \leqslant \overline{T} $.
Оценим норму второго слагаемого из равенства \eqref{s1:increment_x} :
\begin{gather*}
	\left\| \int\limits_{t_0}^T X(T,\tau)\omega(\tau) \ d\tau \right\| \leqslant k_X (T-t_0) \cdot \sup\limits_{\tau \in [t_0, T]} \|\omega(\tau)\|.
\end{gather*}
Тогда из \eqref{s1:lim_omega} следует, что 
\begin{gather*}
 \int\limits_{t_0}^{T} X(T, \tau) \omega(t) \ d\tau = o(\Delta u(\cdot)), \qquad \lim\limits_{\|\Delta u(\cdot) \|_{\mathbb{L}_2} \to 0} \frac{ \| o(\Delta u(\cdot)) \| }{\|\Delta u(\cdot) \|_{\mathbb{L}_2}} = 0.
\end{gather*}
 
То есть, $F(u(\cdot) + \Delta u(\cdot)) - F(u(\cdot)) = \delta x(T) + o(\Delta u(\cdot))$, т.~е. справедливо равенство
\begin{gather}\label{s1:lem2_assert}
 F'(u(\cdot))\delta u(\cdot) =\delta x(T) = \int\limits_{t_0}^{T} X(T, \tau) B(\tau) \delta u(\tau) \ d\tau.
\end{gather}
\hfill $\square$
 
\begin{definition}
 Множеством достижимости $ G(T,\mu) $ системы \eqref{s1:common_nonlinear} в пространстве состояний в момент времени $ T $ назовём множество всех концов траекторий $ x(T, u(\cdot)) \in \mathbb{R}^n $, которые могут быть порождены управлениями $ u(\cdot) \in B_{\mathbb{L}_2}(0,\mu) =\left\lbrace u:\lVert u(\cdot)\rVert^2_{\mathbb{L}_2} \leqslant \mu^2\right\rbrace $,
 \begin{gather*}
 G(T,\mu)=\{x\in \mathbb{R}^n:\exists u(\cdot)\in B_{\mathbb{L}_2}(0,\mu),\; x=x(T,u(\cdot))\}.
 \end{gather*}
\end{definition}
 
Заметим, что множество достижимости $G(T,\mu)$ есть образ гильбертова шара $B_{\mathbb{L}_2}(0,\mu)$ при его отображении $F$.
 
\begin{definition}
	Линейная система $\dot{y} = A(t) y + B(t) u $ называется управляемой (вполне управляемой) на интервале времени $ t_0 \leqslant t \leqslant T $, если для любых $y_0, y_1 \in \mathbb{R}^n$ найдётся управление $u(\cdot) \in \mathbb{L}_2$, переводящее систему из $y(0, u(\cdot)) = y_0 $ в $y(T, u(\cdot)) = y_1 $.
\end{definition}
 
\begin{definition}\label{s1:def:grammian}
 Симметричная матрица, определённая равенством
 \begin{gather*}
 W(T) = \int\limits_{t_0}^{T}X(T,t)B(t)B^{\top}(t)X^{\top}(T,t) \, dt,
 \end{gather*}
 называется грамианом управляемости линейной системы $\dot{y} = A(t) y + B(t) u $ на интервале времени $ t_0 \leqslant t \leqslant T $.
 Как и в Определении \ref{s1:def:linearized_system}, здесь $ X(\tau_1,\tau_0)= \Phi(\tau_1) \Phi^{-1}(\tau_0) $, где $\Phi(t) $ ~--- фундаментальная матрица решений однородной системы, удовлетворяющая уравнению $ \dot{\Phi}(t) = A(t) \Phi(t)$, $ \Phi(t_0) = I $.
\end{definition}
 
Линейная система вполне управляема на $ [t_0, T] $ тогда и только тогда, когда её грамиан управляемости $W(T)$ ~--- положительно определённая матрица \cite[c. 176]{Chen}.
Линеаризованная система \eqref{s1:linearized_system} является частным случаем линейной системы из Определения \ref{s1:def:grammian}. 
 
\subsection{Выпуклость множеств достижимости нелинейных систем с интегральными ограничениями}
\subsubsection{Выпуклость отображения малого шара.}
Пусть $X$, $Y$~--- гильбертовы пространства, а $f: X \rightarrow Y$~--- нелинейное отображение с производной Фреше $f'$, которая существует и непрерывна в некоторой точке $a \in X$.
 
Будем называть точку $a$ регулярной точкой отображения $f$, если линейный оператор $f'(a)$ сюръективен, т.~е. $ f'(a) X = Y $.
Последнее равенство означает, что 
\begin{gather}\label{s1:regularity_cond}
 \forall y \in Y, \quad \exists x \in X, \quad f'(a) x = y.
\end{gather}

Условие \eqref{s1:regularity_cond} называют условием Люстерника\cite{Dmitruk1980}.
В доказательстве теоремы об открытом отображении показано \cite[Теорема 2.11, Теорема 4.13]{Rudin}, что для непрерывного, линейного и сюръективного оператора $f'(a)$ существует такая константа $\nu > 0$, что \\ \mbox{$f'(a) O_X(0, 1) \supset \nu O_Y(0, 1)$}, где $ O_X(0, 1)$ и $O_Y(0, 1)$~--- открытые единичные шары в $X$ и $Y$, соответственно.
Отсюда следует, что
\begin{gather}\label{s1:lyusternik_condition_proof}
 \| f'(a)^* y \| = \sup\limits_{x \in O_X(0, 1)} \big(x,\ f'(a)^* y\big) = \sup\limits_{x \in O_X(0, 1)} \big(f'(a) x,\ y\big) \geqslant \sup\limits_{\overline{y} \in \nu O_Y(0, 1)} \big(\overline{y},\ y\big) = \nu \|y\|,
\end{gather}
для всех $y \in Y$.
Здесь $A^*$ обозначает сопряжённый к $A$ линейный оператор.
 
Например, если множества $X,\ Y$~--- конечномерные, $X = \mathbb{R}^n$, $Y = \mathbb{R}^m$, то условие \eqref{s1:regularity_cond} выполняется, если $ \operatorname{rank} f'(a) = m$.
В этом случае $\nu$ из правой части неравенства \eqref{s1:lyusternik_condition_proof} ~--- наименьшее сингулярное число $f'(a)$. 

\begin{definition}
		Будем называть множество $M \subset X $ сильно выпуклым c радиусом выпуклости $R$, если выполняются следующие эквивалентные условия:
		\begin{enumerate}
			\item $M$ может быть представлено как пересечение замкнутых шаров радиуса $R$,
			\begin{gather*}
				M = \bigcap\limits_{c \in P} B_X (c, R),
			\end{gather*}
			где $P$ --- некоторое множество из $X$.
			\item Для любых точек $x, y \in M$ и любого $\lambda \in [0, 1]$, шар с центром в точке $\lambda x + (1 - \lambda) y $ и радиусом $\frac{\lambda (1 - \lambda)} {2 R} \| x - y \|^2$ содержится в $M$,
			\begin{gather*}
				B_X\left(\lambda x + (1 - \lambda) y, \frac{\lambda (1 - \lambda)} {2 R} \| x - y \|^2\right) \subset M.
			\end{gather*}
		\end{enumerate}
\end{definition}

Понятие сильно выпуклых множеств было введено в работе \cite{Polyak1966}.
В статье \cite{vial} даны пять эквивалентных определений сильной выпуклости, два из которых приведены выше. 
В этой же работе доказана связь сильно выпуклых множеств с сильно выпуклыми функциями. 
Систематическое исследование свойств сильно выпуклых множеств содержится в  \cite{Polovinkin, PolovinkinBalashov}.

В дальнейшем изложении будем опираться на результаты Б.Т. Поляка о выпуклости образа малого шара при его нелинейном отображении, сформулированные в следующей теореме. 
\begin{theorem}[\cite{Polyak2001, Polyak2001ru}]\label{s1:th:PolyakTh}
 Пусть $a \in X$~--- регулярная точка отображения $f: X \rightarrow Y$, производная Фреше $f'$ существует и удовлетворяет условию Липшица на шаре $B_X(a,r) $, $r > 0$, т.~е. существует константа $ L > 0 $ такая, что
 \begin{gather*}%\label{s1:lip_cond}
 \| f'(x) - f'(z) \| \leqslant L \| x - z \|, \quad \forall x,z \in B_X(a,r)
 \end{gather*}
 а также выполнено условие
 \begin{gather*}
 \varepsilon < \min\left\{r,\frac{\nu}{2L}\right\},
 \end{gather*}
 где $\nu$~--- наименьшее сингулярное число отображения $f'(a)$.
 
 Тогда образ шара $B_X(a,\varepsilon) = \{x \in X: \| x - a\| \leqslant \varepsilon\}$ при отображении $f$ является выпуклым, т.~е. $F = \{f(x): x \in B_X(a,\varepsilon)\}$~--- выпуклое множество в $Y$.
 Более того, это множество сильно выпуклое и его граница состоит из образов граничных точек шара: $\partial F \subset f(\partial B_X(a,\varepsilon))$.
\end{theorem}
 
В работах \cite{Polyak2001, Polyak2001ru} теорема доказывается с помощью леммы о решении нелинейного уравнения в гильбертовом пространстве, обоснованной в \cite{Polyak1964} с помощью метода Ньютона.
Отметим, что доказательство Теоремы \ref{s1:th:PolyakTh} может быть построено с опорой и на другие результаты, примыкающие к теореме Люстерника и приведённые в \cite{Dmitruk1980, Ioffe}.
 
Результат Теоремы \ref{s1:th:PolyakTh} можно объяснить следующим образом.
Шар $B_X(a,\varepsilon)$ сильно выпукл, поэтому его образ при линейном отображении $f'(a)$ тоже сильно выпукл.
Но свойство сильной выпуклости устойчиво к малым возмущениям, поэтому оно не теряется при замене линейного отображения $f(a) + f'(a)(x - a)$ на близкое нелинейное отображение $f(x)$. 
 
Результат теоремы можно обобщить, если вместо шара $B_X(a,\varepsilon) $ взять любое другое сильно выпуклое множество.
Однако предположения о гладкости $f$ нельзя существенно ослабить \cite{Polyak2001, Polyak2001ru}.
 
Из этих соображений видно, что теорема не может быть обобщена на банаховы пространства, в которых нет свойства сильной выпуклости шара.
Отметим, что достаточное условие выпуклости образов выпуклых множеств в банаховых пространствах, не использующее свойство сильной выпуклости, было получено в работе \cite{Ledyaev}. 
 
\subsubsection{Выпуклость множеств достижимости при малых ограничениях на управление}
 
Продолжим рассматривать здесь нелинейную систему \eqref{s1:common_nonlinear}, предполагая, что справедливо Предположение \ref{s1:as:right_hand_side_conditions_global} и следующее.
\begin{assumption}\label{s1:as:right_hand_side_diff_lip}
 Функции $f_1(t,x)$ и $f_2(t,x)$ имеют производные по $x$, которые удовлетворяют условию Липшица при всех $t \in [t_0;T]$, $x_1, x_2 \in D$:
 \begin{gather*}
 \left\| \frac{\partial f_1}{\partial x}(t,x_1) - \frac{\partial f_1}{\partial x}(t,x_2) \right\| \leqslant l_{f_1} \| x_1 - x_2\|, \quad \left\| \frac{\partial f_2^k}{\partial x}(t,x_1) - \frac{\partial f_2^k}{\partial x}(t,x_2) \right\| \leqslant l_{f_2^k} \| x_1 - x_2\|,
 \end{gather*}
 где $l_{f_1} > 0$ и $l_{f_2^k} > 0$, $k = 1,...,r$.
\end{assumption}
 
В условиях этого предположения, мы можем сформулировать и доказать лемму о липшицевости матрицы Коши линеаризованной системы \eqref{s1:linearized_system}.
\begin{lemma}\label{s1:lem:lip_fundumental_matrix}
 Пусть выполнены Предположения \ref{s1:as:right_hand_side_conditions_global} и \ref{s1:as:right_hand_side_diff_lip}.
 Тогда найдётся константа $L_X > 0 $ такая, что для всех $u_1(\cdot),\, u_2(\cdot) \in B_{\mathbb{L}_2}(0,\mu)$ и $t, \, s \in [t_0,T]$, 
 \begin{gather*}
 \Big\|X(t,s,u_1(\cdot)) - X(t,s,u_2(\cdot)) \Big\| \leqslant L_X \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2},
 \end{gather*}
 где $X(t,s,u_1(\cdot)) $ и $X(t,s,u_2(\cdot)) $ --- фундаментальные матрицы систем \eqref{s1:linearized_system}, линеаризованных вдоль траекторий $x(\cdot, u_1(\cdot)) $ и $x(\cdot, u_2(\cdot)) $ соответственно. 
\end{lemma}
\doc
Фундаментальная матрица $X(t,s,u(\cdot)) $ системы \eqref{s1:linearized_system} является решением уравнения
\begin{gather*}
 \frac{\partial X(t, s, u(\cdot))}{\partial s} = -A\big(s,u(\cdot)\big)^{\top} X(t, s, u(\cdot)), \quad X\big(t, t, u(\cdot)\big) = I.
\end{gather*}
 
Аналогично \eqref{s1:fundumental_matrix_eq}, решение этого уравнение ограничено, т.~е. существует такая константа $k_X>0$, что
\begin{gather*}
 \| X(t,s, u(\cdot)) \| \leqslant k_X, \qquad t \in [t_0,T], \qquad s \in [t_0,T]
\end{gather*}
для всех $u(\cdot) \in B_{\mathbb{L}_2}(0,\mu)$. 
Для сокращения записи обозначим $A_i(t) = A\big(t, u_i(\cdot)\big) $ и $ X_i(t,s) = X(t, s, u_i(\cdot))$. 
Используя Лемму \ref{s1:lem:lip_of_solutions_global}, в условиях предположения \ref{s1:as:right_hand_side_diff_lip} мы можем получить оценку
\begin{gather}\label{s1:lip_a}
\begin{gathered}
 \| A_1(t) - A_2(t) \| \leqslant 
 \left\| 
 \dfrac{\partial f_1}{\partial x} \Big(t,x\big(t,u_1(\cdot)\big)\Big) 
 - 
 \dfrac{\partial f_1}{\partial x} \Big(t,x\big(t,u_2(\cdot)\big)\Big) 
 \right\| 
 + \\ +
 \left\| 
 \left[ 
 \sum\limits_{k=1}^r 
 \dfrac{\partial f_2^k}{\partial x}\Big(t,x\big(t,u_1(\cdot)\big)\Big) 
 - 
 \dfrac{\partial f_2^k}{\partial x}\Big(t,x\big(t,u_2(\cdot)\big)\Big)
 \right] 
 u_1^k(t) 
 \right\| 
 + \\ +
 \left\| 
 \sum\limits_{k=1}^r 
 \dfrac{\partial f_2^k}{\partial x}\Big(t,x\big(t,u_2(\cdot)\big)\Big)
 \Big(u_1^k(t) - u_2^k(t)\Big) 
 \right\| 
 \leqslant \\ \leqslant
 \Big(l_{f_1} L_x + L_x \sqrt{\sum\limits_{k=1}^r l_{f_2^k}^2} \|u_1(t) \|\Big) \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2} + L_{f_2} \| u_1(t) - u_2(t) \|, \qquad t_0 \leqslant t \leqslant T,\\
 \int\limits_{t_0}^{\tau} \|A_1(s) - A_2(s) \| ds \leqslant L_A \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2}. 
\end{gathered}
\end{gather}
Здесь $l_{f_2} = \sqrt{\sum\limits_{k=1}^r l_{f_2^k}^2}$, а $L_A = l_{f_1} L_x (T - t_0) + l_{f_2} L_x \mu \sqrt{T - t_0} + L_{f_2} \sqrt{T - t_0}$ не зависит от $u_1(\cdot)$, $u_2(\cdot)$ и $\tau$.
Так как
\begin{gather*}
 \frac{\partial}{\partial t} \left(X_1(t,s) - X_2(t,s) \right) = -A_1^{\top}(t) \left(X_1(t,s) - X_2(t,s) \right) + (A_2(t) - A_1(t))^{\top} X_2(t,s), \quad t \in [s,\tau], 
\end{gather*}
приходим к равенству
\begin{gather*}
 X_1(\tau,s) - X_2(\tau,s) = \int\limits_s^{\tau} Y(t,s) \big(A_2(t) - A_1(t)\big)^{\top} X_2(t,s) dt.
\end{gather*}
Здесь $Y(t,s)$ --- это фундаментальная матрица системы 
\begin{gather*}
 \dot{y} = -A_1(t) y.
\end{gather*}
Как и $X_i(\tau,s)$, эта матрица тоже ограничена: существует константа $k_Y>0$ такая, что
\begin{gather*}
 \|Y(t,s)\| \leqslant k_Y, \quad t,s \in [t_0, \tau]
\end{gather*}
для всех $u(\cdot) \in B(0,\mu)$.
Наконец, имеем 
\begin{gather*}
 \| X_1(\tau,s) - X_2(\tau,s) \| \leqslant L_X \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2}, 
\end{gather*} 
где $ L_X = k_Y L_A k_X$.
\hfill$\square$\\[1ex]%-

Введём отображение $\overline{F}: [t_0,T] \times B_{\mathbb{L}_2}(0,\overline{\mu}) \to \mathbb{R}^n$ равенством $\overline{F}(t, u(\cdot)) = x \big(t, u(\cdot)\big) $, где $x \big(t, u(\cdot)\big)$ --- решение системы \eqref{s1:common_nonlinear} в момент $t$, порождённое управлением $u(\cdot)$.
Дифференциал Фреше этого отображения $\overline{F}$ по $u(\cdot)$, $\overline{F}': \mathbb{L}_2 \to \mathbb{R}^n $, согласно Лемме \ref{s1:lem:frechet_derivative_common} --- это решение линеаризованной системы
\begin{gather*}%\label{s1:diff_of_mapping_F}
 \overline{F}'(t, u(\cdot)) \delta u(\cdot) = \delta x(t), 
\end{gather*}
где $\delta x(t)$ --- решение системы \eqref{s1:linearized_system}, отвечающее управлению $\delta u(\cdot)$ и нулевым начальным условиям.

Обозначим грамиан управляемости системы \eqref{s1:linearized_system} через $W(T,u(\cdot))$, где $u(\cdot)$~--- управление, порождающее траекторию системы \eqref{s1:common_nonlinear}, вдоль которой проводится линеаризация.
 
\begin{lemma}\label{s1:lem:lip_dx_global}
 Пусть выполнены Предположения \ref{s1:as:right_hand_side_conditions_global} и \ref{s1:as:right_hand_side_diff_lip}.
 Тогда найдётся константа $L_u > 0$ такая, что для всех $u_1(\cdot),\, u_2(\cdot) \in B_{\mathbb{L}_2}(0,\mu)$ и $t \in [t_0,T]$ выполнено неравенство 
 \begin{gather*}
 \Big\| \overline{F}'(t, u_1(\cdot)) - \overline{F}'(t, u_2(\cdot)) \Big\|_{\mathcal{L}(\mathbb{L}_2, \mathbb{R}^n)} \leqslant L_u \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2}.
 \end{gather*}
 Здесь $\mathcal{L}(\mathbb{L}_2, \mathbb{R}^n)$ --- пространство линейных ограниченных операторов, действующих из $\mathbb{L}_2$ в $\mathbb{R}^n$, а \mbox{$\| \cdot \|_{\mathcal{L}(\mathbb{L}_2, \mathbb{R}^n)}$} --- операторная норма. 
 Для некоторого оператора $T: \mathbb{L}_2 \to \mathbb{R}^n $, $\| T \|_{\mathcal{L}(\mathbb{L}_2, \mathbb{R}^n)} = \sup\limits_{\|x\|_{\mathbb{L}_2} = 1} \| T x \| $.
\end{lemma}
\doc 
Решение \eqref{s1:linearized_system} имеет вид
\begin{gather}\label{s1:xu}
 \delta x\big(t, u_i(\cdot),\delta u(\cdot)\big) = \int\limits_{t_0}^{t} X(t,s,u_i(\cdot)) B(s, u_i(\cdot)) \delta u(s) \ ds,
\end{gather}
где $X(t,s,u(\cdot)) $ --- фундаментальная матрица системы \eqref{s1:linearized_system}. 
Для сокращения записи обозначим $B_i(t) = B\big(t, u_i(\cdot)\big) $ и $ X_i(t,s) = X(t, s, u_i(\cdot))$.
С учётом этих обозначений и \eqref{s1:xu}, имеем
\begin{gather*}
 \Big\| \overline{F}'(t, u_1(\cdot)) \delta u(\cdot) - \overline{F}'(t, u_2(\cdot)) \delta u(\cdot) \Big\| =
 \left\| \int\limits_{t_0}^{t} \Big[ X_1(t,s) B_1(s) - X_2(t,s) B_2(s) \Big] \delta u(s) \ ds \right\| \leqslant \\ \leqslant
 \int\limits_{t_0}^{t} \Big\| X_1(t,s) B_1(s) - X_2(t,s) B_2(s) \Big\| \left\| \delta u(s) \right\| \ ds.
\end{gather*}
Добавляя и вычитая $ X_1(t,s) B_2(s) $, при каждом $s \in [t_0, t] $ получаем
\begin{gather*}
 \Big\| X_1(t,s) B_1(s) - X_2(t,s) B_2(s) \Big\| \leqslant 
 \Big\| X_1(t,s) \Big[B_1(s) - B_2(s) \Big] \Big\| + 
 \Big\| \Big[ X_1(t,s) - X_2(t,s) \Big] B_2(s)\Big\|. 
\end{gather*}
Теперь подставляем это неравенство в оценку нормы разности $\overline{F}'(t, u_1(\cdot)) \delta u(\cdot) $ и $\overline{F}'(t, u_2(\cdot)) \delta u(\cdot) $ и применяем Лемму \ref{s1:lem:lip_fundumental_matrix}:
\begin{gather*}
\begin{gathered}
 \Big\| \overline{F}'(t, u_1(\cdot)) \delta u(\cdot) - \overline{F}'(t, u_2(\cdot)) \delta u(\cdot) \Big\| \leqslant
 \int\limits_{t_0}^{t} L_{f_2} \Big\| X_1(t,s) \Big\| \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2} \left\| \delta u(s) \right\| \ ds + \\ + 
 \int\limits_{t_0}^{t} L_X \max\limits_{(\tau, x ) \in [t_0, \overline{T}] \times D} \| f_2(\tau,x) \| \Big\| \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2} \left\| \delta u(s) \right\| \ ds 
 \leqslant \\ \leqslant 
 \Big( k_{f_2} L_X + L_{f_2} k_X \Big) \sqrt{T - t_0} \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2} \| \delta u(\cdot) \|_{\mathbb{L}_2}.
\end{gathered}
\end{gather*}
Тогда для производных Фреше имеем
\begin{gather*}
	 \Big\| \overline{F}'(t, u_1(\cdot)) - \overline{F}'(t, u_2(\cdot)) \Big\|_{\mathcal{L}(\mathbb{L}_2, \mathbb{R}^n)} = 
	 \max\limits_{\|\delta u(\cdot)\|_{\mathbb{L}_2} = 1} \left\| \Big( \overline{F}'(t, u_1(\cdot)) - \overline{F}'(t, u_2(\cdot)) \Big) \delta u(\cdot) \right\| = \\ =
	 \max\limits_{\|\delta u(\cdot)\|_{\mathbb{L}_2} = 1} \Big\| \overline{F}'(t, u_1(\cdot)) \delta u(\cdot) - \overline{F}'(t, u_2(\cdot)) \delta u(\cdot) \Big\| \leqslant \\ \leqslant \max\limits_{\|\delta u(\cdot)\|_{\mathbb{L}_2} = 1} \Big( k_{f_2} L_X + L_{f_2} k_X \Big) \sqrt{T - t_0} \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2} \| \delta u(\cdot) \|_{\mathbb{L}_2} = \\ =
	 \Big( k_{f_2} L_X + L_{f_2} k_X \Big) \sqrt{T - t_0} \| u_1(\cdot) - u_2(\cdot) \|_{\mathbb{L}_2}.
\end{gather*}
Таким образом, получаем утверждение Леммы и $L_u = \Big( k_{f_2} L_X + L_{f_2} k_X \Big) \sqrt{T - t_0} $.
\hfill$\square$\\[1ex]%--- P r o o f.
 
Заметим, что для отображения $F: B_{\mathbb{L}_2}(0,\overline{\mu}) \to \mathbb{R}^n$, определённого в \eqref{s1:solution_endpoint_mapping}, выполняется $\overline{F}(T, u(\cdot)) = F(u(\cdot))$.
Таким образом, из Леммы \ref{s1:lem:lip_dx_global} следует, что производная Фреше $F'(u(\cdot)) $ является липшицевой. 
 
\begin{theorem}\label{s1:th:small_control_convexity}
 Пусть выполнены Предположения \ref{s1:as:right_hand_side_conditions_global} и \ref{s1:as:right_hand_side_diff_lip}, и пусть линеаризованная вдоль пары $\left( x(\cdot,0),0\right) $ система \eqref{s1:common_nonlinear} является управляемой.
 Тогда найдётся такое $\mu_0 > 0$, что при всех $0 < \mu < \mu_0 $ множества достижимости $G(T, \mu)$ системы \eqref{s1:common_nonlinear} будут выпуклыми.
\end{theorem}
\doc
Рассмотрим отображение $F$, определённое в \eqref{s1:solution_endpoint_mapping}, и его производную Фреше $F'$ в точке $u(\cdot) \equiv 0$. 
 
Верно равенство (см. Лемму \ref{s1:lem:frechet_derivative_common} в условиях Предположения \ref{s1:as:right_hand_side_conditions_global})
\begin{gather}\label{s1:freshet_differential}
 F'(0) \delta u(\cdot) = \int\limits_{t_0}^{T} X(T, \tau, 0) B(\tau, 0) \delta u(\tau) \ d\tau,
\end{gather}
где матрицы $X(\cdot, \cdot, 0)$ и $B(\cdot, 0)$ определены для системы
 \begin{gather}\label{s1:linearized_system_zero_control}
 \begin{gathered}
 		\delta \dot{x} = A(t, 0) \delta x + B(t, 0) \delta u, \qquad t_0 \leqslant t \leqslant T, \qquad \delta x(t_0) = 0, \\
 		A(t, 0) = \dfrac{\partial f_1}{\partial x} \Big(t,x\big(t,0\big)\Big), \qquad
 		B(t, 0) = f_2 \Big(t,x\big(t,0\big)\Big).
 \end{gathered}
\end{gather}
 Система \eqref{s1:linearized_system_zero_control} является линеаризацией системы \eqref{s1:common_nonlinear} вдоль пары $\Big(x(\cdot, 0), 0\Big) $.
Здесь $0$ означает нулевое управление $0(\cdot) \in \mathbb{L}_2$.

Рассмотрим скалярное произведение $ \Big(l, F'(0) \delta u(\cdot)\Big) $, где $ l \in \mathbb{R}^n$:
\begin{gather*}
	\Big(l, F'(0) \delta u(\cdot)\Big)_{\mathbb{R}^n} =
	 l^{\top} \int\limits_{t_0}^{T} X(T, \tau, 0) B(\tau, 0) \delta u(\tau) \ d\tau = \\ = 
	 \int\limits_{t_0}^{T} l^{\top} X(T, \tau, 0) B(\tau, 0) \delta u(\tau) \ d\tau =
	 \Big(F'(0)^* l, \delta u(\cdot)\Big)_{\mathbb{L}_2}.
\end{gather*}
Здесь $ F'(0)^* = B^{\top} (\cdot, 0) X^{\top}(T, \cdot, 0)$.

Обозначим через $W(T,0) $ грамиан управляемости системы \eqref{s1:linearized_system_zero_control}.
Тогда в силу \eqref{s1:freshet_differential} получаем
\begin{gather}\label{s1:self_adjoint_with_derivative}
 F'(0) F'(0)^* = \int\limits_{t_0}^{T} X(T, \tau, 0) B(\tau, 0) B^{\top} (\tau, 0) X^{\top}(T, \tau, 0) \ d\tau= W(T,0).
\end{gather}

Отсюда следует, что регулярность отображения $F$ в точке $u(\cdot) \equiv 0$ определяется положительной определённостью грамиана $W(T,0) $, т.~е. управляемостью линеаризованной системы \eqref{s1:linearized_system_zero_control}. 

При этом константа $\nu$ из неравенства \eqref{s1:lyusternik_condition_proof} связана с наименьшим собственным числом $\lambda$ матрицы $W(T,0) $ равенством $\lambda\big(W(T,0)\big) = \nu^2$.
 
Липшицевость производной Фреше $F'$ на шаре $B_{\mathbb{L}_2}(0,\mu)$ вытекает из Леммы \ref{s1:lem:lip_dx_global} в условиях Предположения \ref{s1:as:right_hand_side_diff_lip}. 
 
Применим Теорему \ref{s1:th:PolyakTh} к $F$ с нулевым управлением $u(\cdot) \equiv 0$ в роли точки $a$. 
Тогда имеем, что множество достижимости $G(T,\mu)$ выпукло при $ 0 < \mu \leqslant \mu_0 $, где 
\begin{gather}\label{s1:mu0}
 \mu_0 = \min\left( \dfrac{\sqrt{\lambda\big(W(T,0)\big)}}{2L_u}, \overline{\mu} \right), 
\end{gather}
а константа $L_u $ определена в Лемме \ref{s1:lem:lip_dx_global}. 
\hfill$\square$\\[1ex]%--- P r o o f.

Выпуклость множеств достижимости при малых ограничениях на ресурс управления была доказана в \cite{Polyak2004} для системы
\begin{gather}
	\dot{x} = \phi(x,u,t),
\end{gather}
при следующих предположениях.
\begin{itemize}
	\item[A1–A3.] Функция $\phi(x,u,t)$ непрерывна по $x$, $u$, измерима по $t$ и удовлетворяет следующим предположениям:
	\begin{itemize}
		 \item[--] Условию роста при всех $x$, $u$, $0 \leqslant t \leqslant T$ 
	\begin{gather}\label{s1:growth}
	\|\phi(x,u,t) \| \leqslant k_1 + k_2 \|x\| + k_3 \|u\|.
	\end{gather}
	\item[--] Условию равномерной локальной липшицевости при $\|x\| \leqslant k_0$, $\|x + \overline{x}\| \leqslant k_0$, $u$, $u + \overline{u}$ и $0 \leqslant t \leqslant T$
	\begin{gather}\label{s1:PolyakLIP}
	\|\phi(x,u,t) - \phi(x + \overline{x},u + \overline{u},t)\| \leqslant k_4 \|\overline{x}\| + k_5 \|\overline{u}\| + k_6 \overline{u}^{\top} \overline{u}.
\end{gather}
	\item[--] Условию дифференцируемости по $x$, $u$ с ограниченной производной \mbox{$\|\phi_x(x,u,t)\| \leqslant k_8$} и квадратичным остатком при  $\|x\| \leqslant k_0$, $\|x + \overline{x}\| \leqslant k_0$, $u$, $u + \overline{u}$ и $0 \leqslant t \leqslant T$
\begin{gather}\label{s1:PolyakDiff}
	\begin{gathered}
		\|\phi(x,u,t) - \phi(x + \overline{x},u + \overline{u},t) -\phi_x(x,u,t) \overline{x} - \phi_u(x,u,t)\overline{u} \| \leqslant k_9 \|\overline{x}\|^2 + k_{10} \overline{u}^{\top} \overline{u}.
	\end{gathered}
\end{gather}
\end{itemize}
	Здесь $k_i > 0$ для $i = 0, \ldots,10$.
	\item[A4.] Для всех $\| x\| \leqslant k_0$, $u$, $0 \leqslant t \leqslant T$ частные производные $\phi_x(x,u,t)$ и $\phi_u(x,u,t)$ липшицевы по $x$, $u$.
	\item[A5.] Линеаризованная система управляема.
\end{itemize}

Таким образом,  с одной стороны, в отличии от диссертации, в \cite{Polyak2004} рассматривается более широкий класс систем. 
С другой стороны, на систему накладывается большее количество предположений, проверка которых может быть связана с трудностями.
Так, условие \eqref{s1:growth} заменено требованием ограниченности решений, а условия \eqref{s1:PolyakLIP}, \eqref{s1:PolyakDiff} не используются. 
Необходимые условия липшицевости вытекают из требования ограниченности решений и непрерывности частных производных функций из правой части системы.
Кроме того, предположения из \cite{Polyak2004} не допускают рассмотрение систем с такими нелинейностями, как $x^3$ или $ xu $ в правой части системы. 
При этом, системы с такими нелинейности, могут удовлетворять предположениям диссертации и рассматриваются в примерах (например, примеры с билинейной системой в разделе \ref{s1:examples} и осцилятором Дуффинга в разделах \ref{s2:examples} и \ref{sec3:examples}).

 
\subsubsection{Выпуклость множеств достижимости на малых интервалах времени}
\label{s1:small_time_subsection}
Рассмотрим нелинейную систему \eqref{s1:common_nonlinear} на малом интервале времени $\ t_0 \leqslant t \leqslant t_0 + \overline{\varepsilon} $.
\begin{gather}\label{s1:common_nonlinear_small_time}
 \dot{x}(t)=f_1(t,x(t))+f_2(t,x(t))u(t), \qquad x(t_0) = x_0.
\end{gather}
Здесь $ \overline{\varepsilon} $ ~--- некоторое фиксированное положительное число.
Управление $u(\cdot)$ будем выбирать из пространства интегрируемых с квадратом функций $\mathbb{L}_2[t_0,t_0+\overline{\varepsilon}]$ и ограничим шаром радиуса $ 0 < \mu < \overline{\mu} $ в этом пространстве, который будем обозначать через $B_{\mathbb{L}_2}(0, \mu)$:
\begin{gather*}
 \lVert u(\cdot)\rVert^2_{\mathbb{L}_2} = \left(u(\cdot),u(\cdot) \right)_{\mathbb{L}_2} \leqslant \mu^2.
\end{gather*}

Принятые в предыдущих разделах Предположения \ref{s1:as:right_hand_side_conditions_global} и \ref{s1:as:right_hand_side_diff_lip} относительно функций $f_1$ и $f_2$ будем считать справедливыми на интервале $t_0 \leqslant t \leqslant t_0 + \overline{\varepsilon} $ при управлениях $u(\cdot) \in B_{\mathbb{L}_2}(0, \overline{\mu}) $, $\overline{\mu} > 0$.

Пусть $ 0 < \varepsilon \leqslant \overline{\varepsilon} $.
 
 
Используя замену времени, сведём задачу описания множества достижимости на малом интервале к аналогичной задаче на фиксированном интервале для системы, уравнения которой и интегральные ограничения на управление зависят от малого параметра.
Произведя замену времени $ t = \varepsilon \tau + t_0 $ и приняв обозначения $ z(\tau) = x(\varepsilon \tau + t_0) $ и $ \upsilon(\tau) = \varepsilon u(\varepsilon \tau + t_0) $, получим из \eqref{s1:common_nonlinear_small_time}
\begin{gather}\label{s1:eps_nonlinear}
 \dot{z}(\tau)=\widetilde{f}_1(\tau,z(\tau))+\widetilde{f}_2(\tau,z(\tau))\upsilon(\tau), \qquad 0 \leqslant \tau \leqslant 1, \qquad z(0) = x_0,
\end{gather}
где $ \widetilde{f}_1(\tau,z) = \varepsilon f_1(\varepsilon \tau + t_0,z) $, $ \widetilde{f}_2 (\tau,z) = f_2(\varepsilon \tau + t_0,z)$, а управление $ \upsilon(\cdot) $ удовлетворяет ограничению
\begin{gather*}%\label{s1:eps_control_constaint}
 \int_0^1 \upsilon^{\top}(\tau) \upsilon(\tau) \, d\tau \leqslant \left( \mu \sqrt{\varepsilon}\right)^2.
\end{gather*}

Далее будем использовать обозначение $\mathbb{L}_2 = \mathbb{L}_2[0, 1]$. 

Каждому решению $z(\cdot, \upsilon(\cdot))$ системы \eqref{s1:eps_nonlinear} на нормированном интервале времени $[0, 1]$, отвечающему управлению $\upsilon(\cdot) \in B_{\mathbb{L}_2[0, 1]} (0, \overline{\mu} \sqrt{\varepsilon})$, можно поставить в соответствие решение $x(\cdot, u(\cdot))$ системы \eqref{s1:common_nonlinear_small_time}, отвечающее управлению $u(\cdot) \in B_{\mathbb{L}_2[t_0, t_0 + \varepsilon]} (0, \overline{\mu})$, причём для $\tau \in [0, 1] $ выполняется $ \upsilon(\tau) = \varepsilon u(\varepsilon \tau + t_0)$ и $ z(\tau, \upsilon(\cdot)) = x(\varepsilon \tau + t_0, u(\cdot)) $.
Из последнего равенства и справедливости Предположения \ref{s1:as:right_hand_side_conditions_global} для системы \eqref{s1:common_nonlinear_small_time} следует, что для всех $\upsilon(\cdot) \in B_{\mathbb{L}_2}(0, \overline{\mu}\sqrt{\varepsilon})$ и всех $\tau \in [0, 1] $ выполняется $z(\tau, \upsilon(\cdot)) \in D$. 

Таким образом, система \eqref{s1:eps_nonlinear} удовлетворяет Предположению \ref{s1:as:right_hand_side_conditions_global} в области $[0, 1]\times D$ и $\upsilon(\cdot) \in B_{\mathbb{L}_2}(0, \overline{\mu}\sqrt{\varepsilon}) $.
Из этого следует, что Лемма \ref{s1:lem:lip_of_solutions_global} справедлива для системы \eqref{s1:eps_nonlinear}.
Функции $\widetilde{f}_1$ и $\widetilde{f}_2$ удовлетворяют условию Липшица по $x$ на множестве $[0, 1]\times D$ с константами $\widetilde{L}_{f_1} = \varepsilon L_{f_1} $ и $\widetilde{L}_{f_2} = L_{f_2} $ соответственно. 

Действительно, для произвольных $z_1, z_2 \in D$ и всех $\tau \in [0, 1]$ справедливо
\begin{gather*}
	\| \widetilde{f}_1(\tau, z_1) - \widetilde{f}_1(\tau, z_2) \| = \| \varepsilon f_1(\varepsilon \tau + t_0, z_1) - \varepsilon f_1(\varepsilon \tau + t_0, z_2) \| = \\ =
	\varepsilon \| f_1(\varepsilon \tau + t_0, z_1) - f_1(\varepsilon \tau + t_0, z_2) \| \leqslant \varepsilon L_{f_1} \|z_1 - z_2 \|, \\
	\| \widetilde{f}_2 (\tau,z_1) - \widetilde{f}_2 (\tau,z_2) \| = \| f_2(\varepsilon \tau + t_0,z_1) - f_2(\varepsilon \tau + t_0,z_2) \| \leqslant L_{f_2} \|z_1 - z_2 \|.
\end{gather*}
 
Из Леммы \ref{s1:lem:lip_of_solutions_global}, применённой к системе \eqref{s1:eps_nonlinear}, следует
\begin{gather*}
 \left\| z_1\big(t, \upsilon_1(\cdot) \big) - z_2\big(t, \upsilon_2(\cdot)\big) \right\| \leqslant L_z \left\|\upsilon_1(\cdot) - \upsilon_2(\cdot) \right\|_{\mathbb{L}_2},
\end{gather*}
где $ L_z = k_{f_2} \exp\Big( L_{f_1} \varepsilon + L_{f_2} \mu \sqrt{\varepsilon} \Big) \leqslant k_{f_2} \exp\Big( L_{f_1} \overline{\varepsilon} + L_{f_2} \mu \sqrt{\overline{\varepsilon}} \Big)$.
 
Обозначим через $G_{\varepsilon}(\tau)$ множество достижимости системы \eqref{s1:eps_nonlinear} в момент времени $\tau$:
\begin{gather*}
 G_{\varepsilon}(\tau) = \{z\in \mathbb{R}^n:\exists \upsilon(\cdot)\in \mathbb{L}_2, \lVert \upsilon(\cdot)\rVert_{\mathbb{L}_2}
 \leqslant \mu \sqrt{\varepsilon}, \; z=z(\tau, \upsilon(\cdot))\}.
\end{gather*}
По аналогии с \eqref{s1:linearized_system_zero_control} линеаризуем \eqref{s1:eps_nonlinear} вдоль траектории $ z(\cdot,0) = x(\cdot, 0) $
\begin{gather}\label{s1:eps_linearized}
 \delta\dot{z} = \widetilde{A}_{\varepsilon}(\tau, 0) \delta z(\tau) +\widetilde{B}_{\varepsilon}(\tau, 0) \delta \upsilon(t),\qquad 0 \leqslant \tau \leqslant 1, \qquad \delta z(0) = 0,
\end{gather}
где $ \widetilde{A}_{\varepsilon}(\tau, \upsilon(\cdot)) = \varepsilon A(\varepsilon \tau + t_0, u(\cdot)) $, $\widetilde{B}_{\varepsilon}(\tau, \upsilon(\cdot)) = B(\varepsilon \tau + t_0, u(\cdot)) $. 
Для сокращения записи введём обозначения $A_{\varepsilon}(\tau) = \widetilde{A}_{\varepsilon}(\tau, 0)$ и $B_{\varepsilon}(\tau) = \widetilde{B}_{\varepsilon}(\tau, 0)$.
Фундаментальная матрица $ X_{\varepsilon}(\tau,\xi) $ системы \eqref{s1:eps_linearized} определяется как решение уравнения
\begin{gather*}
 \frac{dX_{\varepsilon}(\tau,\xi)}{d\tau} = A_{\varepsilon}(\tau) X_{\varepsilon}(\tau,\xi), \qquad X_{\varepsilon}(\tau,\tau) = I. 
\end{gather*}

Если система \eqref{s1:eps_nonlinear} была линеаризована вдоль траектории $ z(\tau, \upsilon(\cdot)) $, то фундаментальную матрицу такой линейной системы будем обозначать как $X_{\varepsilon}(\cdot,\cdot, \upsilon(\cdot)) $.
Обозначим через $ W_{\varepsilon}(\tau, 0) $ грамиан управляемости системы \eqref{s1:eps_linearized}. 
Для упрощения записи будем опускать последний аргумент грамиана управляемости, подразумевая нулевое управление, т.~е. $W_{\varepsilon}(\tau) = W_{\varepsilon}(\tau, 0) $.
Кроме того, для $\tau = 1$ будем использовать сокращённое обозначение $W_{\varepsilon}(1, 0) = W_{\varepsilon}$. 

Справедливо следующее утверждение.

\begin{utv}\label{s1:utv:connection_with_scaled_system}
 Для множеств достижимости систем \eqref{s1:common_nonlinear_small_time} и \eqref{s1:eps_nonlinear} и грамианов управляемости систем \eqref{s1:linearized_system} и \eqref{s1:eps_linearized} имеют место равенства
 \begin{gather*}
 G_{\varepsilon}(1) = G(t_0 + \varepsilon), \qquad
 W_{\varepsilon} = \dfrac{1}{\varepsilon} W(\varepsilon, 0)
 \end{gather*}
\end{utv}

\doc 
Действительно, равенство областей достижимости следует из равенства $ x(t_0 + \varepsilon, u(\cdot)) = z(1, \upsilon(\cdot)) $, где $ \upsilon(\tau) = \varepsilon u(\varepsilon \tau + t_0) $.

Фундаментальные матрицы систем \eqref{s1:linearized_system} и \eqref{s1:eps_linearized} эквивалентны с учётом замены времени и обозначения $ X_{\varepsilon}(\tau,\xi) = X(\varepsilon \tau + t_0,\varepsilon \xi + t_0, 0) $:
\begin{gather*}
	\frac{dX(t,\zeta, 0)}{dt} = A(t, 0) X(t,\zeta, 0), \\
	\zeta = \varepsilon \xi + t_0, \qquad t = \varepsilon \tau + t_0, \\
	\frac{dX(\varepsilon \tau + t_0, \varepsilon \xi + t_0, 0)}{d\tau} = A(\varepsilon \tau + t_0, 0) X(\varepsilon \tau + t_0,\varepsilon \xi + t_0, 0), \\
	\frac{dX_{ \varepsilon}(\tau,\xi)}{d\tau} = A_{\varepsilon}(\tau) X_{ \varepsilon}(\tau,\xi), \qquad X_{\varepsilon}(\tau,\tau) = I.
\end{gather*}

Для грамианов управляемости имеем
\begin{gather*}
\begin{gathered}
 W_{\varepsilon} =
 \int\limits_0^1
 X_{ \varepsilon} (1,\tau)
 B_{\varepsilon}(\tau)
 B_{\varepsilon}^{\top}(\tau)
 X_{ \varepsilon}^{\top} (1,\tau) \, d\tau = \\
 = \dfrac{1}{\varepsilon} \int\limits_{t_0}^{t_0+\varepsilon}
 X(t_0+\varepsilon,\varepsilon \tau + t_0)
 B(\varepsilon \tau + t_0)
 B^{\top}(\varepsilon \tau + t_0)
 X^{\top}(t_0+\varepsilon,\varepsilon \tau + t_0) \,
 d\left( \varepsilon\tau + t_0\right) = \\ =
 \dfrac{1}{\varepsilon} \int\limits_{t_0}^{t_0+\varepsilon}
 X(t_0+\varepsilon,t, 0)
 B(t, 0)
 B^{\top}(t, 0)
 X^{\top}(t_0+\varepsilon,t, 0) \, dt = \dfrac{1}{\varepsilon} W(\varepsilon, 0). 
\end{gathered}
\end{gather*}

Таким образом, грамиан линеаризованной системы с заменённым временем \eqref{s1:eps_linearized} может быть выражен через грамиан линеаризованной в исходном времени системы \eqref{s1:linearized_system}.  \hfill $\square$
 
Как и в предыдущем разделе, определим отображение $S: \mathbb{L}_2[0,1] \rightarrow \mathbb{R}^n $ равенством $S(\upsilon(\cdot)) = z(1,\upsilon(\cdot))$. 
Здесь $ z(1,\upsilon(\cdot))$ ~--- решение системы \eqref{s1:common_nonlinear_small_time}, порождённое управлением $\upsilon(\cdot)$. 
 
Применяя Лемму \ref{s1:lem:frechet_derivative_common} к отображению $S$, заключаем, что производная Фреше этого отображения определяется равенством $ S'(\upsilon(\cdot))\delta \upsilon(\cdot) = \delta z(1)$, где $\delta z(t)$ ~--- решение линеаризованной вдоль пары $\big( z(\cdot,\upsilon(\cdot)),\upsilon(\cdot)\big) $ системы \eqref{s1:eps_linearized}, порождённое управлением $\delta \upsilon(\cdot)$ при нулевых начальных условиях, т.~е.
\begin{gather*}
	S'(\upsilon(\cdot))\delta \upsilon(\cdot) = \int\limits_0^1 X_{\varepsilon}(1, \tau, \upsilon(\cdot)) \widetilde{B}_{\varepsilon}(\tau, \upsilon(\cdot)) \delta\upsilon(\tau)\ d\tau. 
\end{gather*}
 
Функции $\widetilde{f}_1$ и $\widetilde{f}_2$ удовлетворяют Предположению \ref{s1:as:right_hand_side_diff_lip} на множестве $[0, 1]\times D$ с константами $\widetilde{l}_{f_1} = \varepsilon l_{f_1} $ и $\widetilde{l}_{f_2^k} = l_{f_2^k} $ соответственно. 

Действительно, для произвольных $z_1, z_2 \in D$ и всех $\tau \in [0, 1]$ справедливо
\begin{gather*}
	 \left\| \frac{\partial \widetilde{f}_1}{\partial z}(\tau, z_1) - \frac{\partial \widetilde{f}_1}{\partial z}(\tau, z_2) \right\| = 
	 \left\| \varepsilon \frac{\partial f_1}{\partial z}(\varepsilon \tau + t_0, z_1) - \varepsilon \frac{\partial f_1}{\partial z}(\varepsilon \tau + t_0, z_2) \right\| = \\ =
	 \varepsilon \left\| \frac{\partial f_1}{\partial z}(\varepsilon \tau + t_0, z_1) - \frac{\partial f_1}{\partial z}(\varepsilon \tau + t_0, z_2) \right\| 
	 \leqslant \varepsilon l_{f_1} \| z_1 - z_2\|, \\
	 \left\| \frac{\partial \widetilde{f}_2}{\partial z}(\tau,z_1) - \frac{\partial \widetilde{f}_2}{\partial z}(\tau,z_2) \right\| = 
	\left\| \frac{\partial f_2^k}{\partial z}(\varepsilon \tau + t_0,z_1) - \frac{\partial f_2^k}{\partial z}(\varepsilon \tau + t_0,z_2) \right\| 
	\leqslant l_{f_2^k} \| z_1 - z_2\|.
\end{gather*}
 
По аналогии с \eqref{s1:lip_a}, для произвольных $ \upsilon_1(\cdot), \upsilon_2(\cdot) \in B_{\mathbb{L}_2}(0,\mu\sqrt{\varepsilon})$ можем выписать
\begin{gather*}
 \int\limits_{0}^{1} \|\widetilde{A}_{\varepsilon}(s, \upsilon_1(\cdot)) - \widetilde{A}_{\varepsilon}(s, \upsilon_2(\cdot)) \| ds \leqslant \widetilde{L}_A \| \upsilon_1(\cdot) - \upsilon_2(\cdot) \|_{\mathbb{L}_2},
\end{gather*}
 где 
\begin{gather*}%\label{s1:eps_lip_a}
 \widetilde{L}_A = \widetilde{l}_{f_1} L_z + \widetilde{l}_{f_2} L_z \mu \sqrt{\varepsilon} + \widetilde{L}_{f_2} = 
 L_{f_2} + k_{f_2} \Big( l_{f_1} \varepsilon + l_{f_2} \mu \sqrt{\varepsilon} \Big) \exp\big( L_{f_1} \varepsilon + L_{f_2} \mu \sqrt{\varepsilon} \big).
 \end{gather*}
 
 Применяя Лемму \ref{s1:lem:lip_dx_global} к отображению $S$, получаем, что отображение $S'(\upsilon)$ удовлетворяет условию Липшица с константой 
 \begin{gather}\label{s1:lip_eps}
 \begin{gathered}
 	 L_u(\varepsilon) = k_{f_2} k_X k_Y \widetilde{L}_A + \widetilde{L}_{f_2} k_X = \\ = 
 	L_{f_2} k_X + 
 	k_{f_2} k_X k_Y \Big[ L_{f_2} + k_{f_2} \Big( l_{f_1} \varepsilon + l_{f_2} \mu \sqrt{\varepsilon} \Big) \exp\big( L_{f_1} \varepsilon + L_{f_2} \mu \sqrt{\varepsilon} \big) \Big] \leqslant 
 	L_0 + L_1 \varepsilon,
 \end{gathered}
 \end{gather} 
 где 
 \begin{gather*}
 	L_0 = L_{f_2} k_X (1 + k_{f_2} k_Y) + 
 	k_{f_2}^2 k_X k_Y l_{f_2} \mu \sqrt{\overline{\varepsilon}} \exp\big( L_{f_1} \overline{\varepsilon} + L_{f_2} \mu \sqrt{\overline{\varepsilon}} \big) \geqslant 0, \\
 	 L_1 = k_{f_2}^2 k_X k_Y l_{f_1} \exp\big( L_{f_1} \overline{\varepsilon} + L_{f_2} \mu \sqrt{\overline{\varepsilon}} \big) \geqslant 0.
 \end{gather*} 
При этом, если коэффициенты матрицы $f_2$ в уравнении системы не зависят от состояния ($f_2(t,x) = f_2(t)$), то $L_0 = 0$. 
Действительно, в этом случае для любых $x_1, x_2 \in D$, $t\in [t_0, t_0 + \overline{\varepsilon}]$, выполняется $f_2(t,x_1) = f_2(t, x_2)$ и $\dfrac{\partial f_2}{\partial x} (t, x_1) = \dfrac{\partial f_2}{\partial x} (t, x_2)$, поэтому соответствующие константы Липшица можно выбрать нулевыми: $ L_{f_2} = 0$ и $l_{f_2} = 0$.
 
Для самосопряжённого оператора $S'(0)S'(0)^*$ справедливо равенство 
\begin{gather*}
	S'(0)S'(0)^* = W_{\varepsilon}. 
\end{gather*}
 
Тогда управляемость системы \eqref{s1:eps_linearized} (минимальное собственное число $ \lambda(\varepsilon) $ грамиана управляемости $W_{\varepsilon}$ должно быть строго положительно) означает регулярность отображения $S$ при $\upsilon = 0$, а множество достижимости $G_{\varepsilon}$ есть образ гильбертова шара $B_{\mathbb{L}_2}(0,\mu\sqrt{\varepsilon})$ при его отображении $S$.
 
Используя теорему \ref{s1:th:PolyakTh}, сформулируем следующую теорему.
\begin{theorem}\label{s1:th:small_time_convexity}
 Если найдутся такие $K > 0$, $ \alpha > 0$, $ 0 < \varepsilon_0 < \overline{\varepsilon}$, что для всех $\varepsilon \leqslant \varepsilon_0$ выполняется условие
 \begin{gather}\label{s1:small_time_convexity_condition}
 \lambda(\varepsilon) \geqslant \left\{ {\begin{array}{*{20}{l}}
 {K\varepsilon ^{3 - \alpha}, \mbox{\ если \ } f_2(t,x) \mbox{\ не зависит от \ } x}, \\
 {K\varepsilon ^{1 - \alpha}}, \mbox{\ в противном случае},
 \end{array}} \right.
 \end{gather}
 то существует такое $ \varepsilon_1 > 0 $, что множество достижимости $G(\varepsilon)$ системы \eqref{s1:common_nonlinear_small_time} выпукло при всех $\varepsilon < \varepsilon_1 $.
 \end{theorem}
 \doc
Применим теорему \ref{s1:th:small_control_convexity} к системе \eqref{s1:eps_nonlinear}. 
Получаем, что множество достижимости $\widetilde{G}(\varepsilon)$ будет выпукло при выполнении условия \eqref{s1:mu0}, которое в этом случае примет вид
 \begin{gather}\label{s1:th3_proof_origin_condition}
 \lambda(\varepsilon) \geqslant 4 \mu^2 \varepsilon L_u^2 (\varepsilon).
 \end{gather}
 Заметим, что $ \lambda(\varepsilon) $, удовлетворяющие условию 
 \begin{gather}\label{s1:th3_proof_condition_with_f2}
 	 \lambda(\varepsilon) \geqslant 4 \mu^2 \varepsilon (L_0 + L_1 \varepsilon)^2 = 4 \mu^2 L_0^2 \varepsilon + 8 \mu^2 L_0 L_1 \varepsilon^2 + 4 \mu^2 L_1^2 \varepsilon^3,
 \end{gather}
 будут удовлетворять и условию \eqref{s1:th3_proof_origin_condition}. 
 Константы $L_0$ и $L_1$ определены в \eqref{s1:lip_eps}. 
 В соответствии с Утверждением \ref{s1:utv:connection_with_scaled_system} множества достижимости систем \eqref{s1:common_nonlinear_small_time} и \eqref{s1:eps_nonlinear} совпадают.
 Поэтому \eqref{s1:th3_proof_condition_with_f2} является условием выпуклости не только множества достижимости $\widetilde{G}(\varepsilon)$ системы \eqref{s1:eps_nonlinear}, но и множества достижимости $G(\varepsilon)$ системы \eqref{s1:common_nonlinear_small_time}.
 
 Рассмотрим случай, когда $f_2(t,x)$ не зависит от $x$.
 Тогда $L_0 = 0$ и условие \eqref{s1:th3_proof_condition_with_f2} принимает вид
 \begin{gather}\label{s1:th3_proof_condition_without_f2}
 	\lambda(\varepsilon) \geqslant 4 \mu^2 L_1^2 \varepsilon^3.
 \end{gather}
 
Требуется доказать, что если для каких-то $K > 0$, $\alpha > 0$ и $ 0 < \varepsilon_0 < \overline{\varepsilon}$ условие $ \lambda(\varepsilon) \geqslant K\varepsilon ^{3 - \alpha} $ выполняется при всех $\varepsilon \leqslant \varepsilon_0$, то существует такое $ \varepsilon_1 > 0 $, что при $\varepsilon < \varepsilon_1 $ справедливо и условие \eqref{s1:th3_proof_condition_without_f2}.
Для этого необходимо, чтобы 
\begin{gather}\label{s1:th3_proof_final_condition_without_f2}
	K\varepsilon ^{3 - \alpha} \geqslant 4 \mu^2 L_1^2 \varepsilon^3.
\end{gather}

 Отсюда
 \begin{gather*}
 	\varepsilon \leqslant \left(\frac{K}{4 \mu^2 L_1^2}\right)^{\frac{1}{\alpha}}.
 \end{gather*}
 
 Обозначим $\varepsilon_1 = \min \left(\varepsilon_0, \left(\frac{K}{4 \mu^2 L_1^2}\right)^{\frac{1}{\alpha}} \right) $.
 Тогда для всех $\varepsilon < \varepsilon_1 $ будет выполняться \eqref{s1:th3_proof_final_condition_without_f2}, а значит и \eqref{s1:th3_proof_condition_without_f2}.
 

Теперь вернёмся к рассмотрению общего случая, когда $f_2(t,x)$ зависит от $x$.
Здесь мы доказываем, что если для каких-то $K > 0$, $\alpha > 0$ и $ 0 < \varepsilon_0 < \overline{\varepsilon}$ условие $ \lambda(\varepsilon) \geqslant K\varepsilon ^{1 - \alpha} $ выполняется при всех $\varepsilon \leqslant \varepsilon_0$, то существует такое $ \varepsilon_1 > 0 $, что при $\varepsilon < \varepsilon_1 $ справедливо и условие \eqref{s1:th3_proof_condition_with_f2}. 
Для этого необходимо, чтобы 
\begin{gather*}
	K\varepsilon ^{1 - \alpha} \geqslant 4 \mu^2 L_0^2 \varepsilon + 8 \mu^2 L_0 L_1 \varepsilon^2 + 4 \mu^2 L_1^2 \varepsilon^3,
\end{gather*}
т.~е. 
\begin{gather}\label{s1:th3_proof_final_condition_with_f2}
	K \geqslant 4 \mu^2 \varepsilon^{\alpha} (L_0^2 + 2 L_0 L_1 \varepsilon + L_1^2 \varepsilon^2).
\end{gather}
 
 Заметим, что правая часть \eqref{s1:th3_proof_final_condition_with_f2} обращается в нуль при $\varepsilon = 0$ и непрерывна при $\varepsilon > 0$, а значит существует такое $\varepsilon_2 > 0$, что \eqref{s1:th3_proof_final_condition_with_f2} выполняется при всех $\varepsilon < \varepsilon_2 $.
 Обозначим $\varepsilon_1 = \min \left(\varepsilon_0, \varepsilon_2\right) $. 
 Тогда для всех $\varepsilon < \varepsilon_1 $ будет выполняться \eqref{s1:th3_proof_final_condition_with_f2}, а значит и \eqref{s1:th3_proof_condition_with_f2}.
 \hfill$\square$\\[1ex]%--- P r o o f.
 
 Близкий результат был получен в работе \cite{GusevMotor}, здесь приведено более подробное доказательство и уточнены оценки для констант.
 
 \begin{zam}
 	Теорема \ref{s1:th:small_time_convexity} даёт удобное достаточное условие выпуклости множеств достижимости нелинейных систем \eqref{s1:common_nonlinear_small_time} на малых интервалах времени, не требующее трудоёмкого вычисления констант $L_0$ и $L_1$.
 	Однако величина $\varepsilon_1$, полученная таким образом, может оказаться консервативной. 
 	Для того, чтобы приблизить её к границе, на которой условие \eqref{s1:th3_proof_origin_condition} действительно перестанет выполняться, имеет смысл выбирать $\alpha$ как можно меньше, а $K$ как можно больше. 
 	Либо, если необходима точная оценка этой границы, использовать непосредственно условие \eqref{s1:th3_proof_origin_condition}.
 	Далее, во второй главе будут приведены примеры нелинейных систем, множества достижимости которых сохраняют выпуклость и при $ \varepsilon = 1$.
 \end{zam}
 \subsection{Асимптотика собственных чисел грамиана управляемости линейной системы с малым параметром} 
Для проверки условий теоремы \ref{s1:th:small_time_convexity} необходимо оценивать асимптотику минимального собственного числа грамиана управляемости линеаризованной системы с малым параметром.
В этом разделе предложен один из возможных способов проверки асимптотики собственных чисел грамиана управляемости таких систем.
Из полученной асимптотики следует выпуклость множеств достижимости на малых интервалах времени для некоторых классов нелинейных систем второго порядка.
Это свойство продемонстрировано на ряде примеров.

\paragraph{Постановка задачи.} На конечном интервале времени $ 0 \leqslant t \leqslant 1 $ рассматривается линейная стационарная динамическая система 
\begin{gather}\label{s1:eps_linear_system}
 \dot{x} = \varepsilon A x + Bu, 
\end{gather}
где $ \varepsilon > 0, \ x \in \mathbb{R}^n, \ u \in \mathbb{R}^r, \ A \in \mathbb{R}^{n\times n}, \ B \in \mathbb{R}^{n\times r} $.
Будем предполагать, что пара $ \left( A, B\right) $ вполне управляема.
Требуется оценить зависимость минимального собственного числа $ \lambda_{\varepsilon} $ грамиана управляемости $ W_{\varepsilon} $ системы \eqref{s1:eps_linear_system} от малого параметра $ \varepsilon $.
\subsubsection{Рекуррентная процедура}
Напомним, что грамиан управляемости линейной стационарной вполне управляемой системы \eqref{s1:eps_linear_system}~--- положительно-определённая симметричная матрица, определяемая равенством
\begin{gather}\label{s1:gram_int_def}
 W_{\varepsilon}(t) = \int \limits_0^t X(t,\tau) B B^{\top} X^{\top}(t,\tau) d\tau,
\end{gather}
где $ X(t,\tau) $~--- фундаментальная матрица решений системы \eqref{s1:eps_linear_system} ($ \dot{X}(t,\tau) = \varepsilon A X(t,\tau)$, $X(\tau,\tau) = I $).
Заметим также, что грамиан управляемости $ W_{\varepsilon}(t) $ может быть найден, как решение следующего линейного матричного дифференциального уравнения:
\begin{gather}\label{s1:gram}
 \dot{W_{\varepsilon}}(t) = \varepsilon A W_{\varepsilon}(t) + \varepsilon W_{\varepsilon}(t) A^T + BB^T, \ W_{\varepsilon}(0) = 0.
\end{gather}

Это проверяется дифференцированием равенства \eqref{s1:gram_int_def}.
Нас интересует значение грамиана управляемости в момент времени $ t = 1$, $ W_{\varepsilon}(1) = W_{\varepsilon}$.
Будем искать решение \eqref{s1:gram} в следующем виде:
\begin{gather}\label{s1:We}
 W_{\varepsilon}(t) = W_0(t) + \varepsilon W_1(t) + \varepsilon^2 W_2(t) + \dots + \varepsilon^n W_n(t) + \dots 
\end{gather}
 
Продифференцируем \eqref{s1:We} по $ t $:
\begin{gather}\label{s1:dWe}
 \dot{W_{\varepsilon}}(t) = \dot{W_0} + \varepsilon \dot{W_1} + \varepsilon^2 \dot{W_2} + \dots + \varepsilon^n \dot{W_n} + \dots 
\end{gather}
 
Подставим \eqref{s1:dWe} и \eqref{s1:We} в \eqref{s1:gram} и приравняем коэффициенты при соответствующих степенях $ \varepsilon $.
При $ \varepsilon $ в нулевой степени  имеем
\begin{gather*}
 \dot{W}_0 = B B ^T, \qquad W_0(t) = B B ^Tt.
\end{gather*}
 
Обозначив $ B B^T = U_0 $ и подставив $ t = 1$, получим $ W_0(1) = U_0$.
Коэффициенты при $ \varepsilon$:
\begin{gather*}
 \dot{W}_1 = A W_0 + W_0 A^T = t \left( A U_0 + U_0 A^T \right) = t U_1, \qquad W_1(t) = \frac{t^2}{2}U_1.
\end{gather*}
 
Аналогично,
\begin{gather*}
 \dot{W}_2 = A W_1 + W_1 A^T = \dfrac{t^2}{2} \left( A U_1 + U_1 A^T \right) = \dfrac{t^2}{2} U_2, \qquad W_2(t) = \dfrac{t^3}{6}U_2.
\end{gather*}
 
Продолжая данную цепочку равенств, разложение грамиана управляемости системы \eqref{s1:eps_linear_system} на интервале времени $0 \leqslant t \leqslant 1 $ по степеням малого параметра $ \varepsilon $ можно записать как:
\begin{gather}\label{s1:gram1}
 W_{\varepsilon} = U_0 + \dfrac{\varepsilon}{2}U_1 + \dfrac{\varepsilon^2}{6} U_2 + \dfrac{\varepsilon^3}{24}U_3 + \dfrac{\varepsilon^4}{120}U_4 + \dots + \dfrac{\varepsilon^k}{(k+1)!}U_k,
\end{gather}
где
\begin{gather*}
 U_0 = B B^T, \\
 U_i = A U_{i-1} + U_{i-1} A^T, \ i \geqslant 1.
\end{gather*}
 
Если матрица $ A $ системы \eqref{s1:eps_linear_system} нильпотентна, со степенью нильпотентности $ k $, то ряд \eqref{s1:gram1} конечен, так как коэффициенты $ U_i, \ i \geqslant k$, содержат $ A $ в степенях больше $ k$ и, следовательно, равны нулю.

В противном случае необходимо убедиться, что ряд \eqref{s1:gram1} сходится. 
Введём обозначение $ S_i = \dfrac{\varepsilon^i U_i}{(i + 1)!} $, $i \in \mathbb{N}$.
Тогда $W_{\varepsilon} = \sum\limits_{i = 0}^{\infty} S_i$.
Оценим норму коэффициентов $ U_i $, $ i \geqslant 0$:
\begin{gather*}
	\| U_i \| \leqslant C \|A\|^i \|U_0\|, 
\end{gather*}
где $C > 0$. 
Тогда для всех $i$
\begin{gather}\label{s1:compare}
		\|S_i\| \leqslant \frac{C \|A\|^i \|U_0\| \varepsilon^i}{(i + 1)!}.
\end{gather} 
 
 Отсюда следует, что ряд \eqref{s1:gram1} сходится, так как сходится ряд справа в \eqref{s1:compare}.
 
\subsubsection{Некоторые частные случаи}
\label{s1:examples}
Приведём несколько примеров линейных систем второго порядка, для грамианов управляемости которых выполняется условие \eqref{s1:small_time_convexity_condition}.
Рассмотрим простейшую систему, а также более общие случаи, такие как произвольные системы с одним входом, а также системы с двумя входами и вырожденной/невырожденной матрицей управления.

После этого продемонстрируем применение описанного в предыдущем разделе метода к проверке выпуклости множеств достижимости двух нелинейных систем, используя теорему~\ref{s1:th:small_time_convexity}.

\paragraph{Двойной интегратор.}
Наиболее простой частный случай~--- система вида 
\begin{gather*}
 \left[ {\begin{array}{*{20}{c}}
 {{{\dot x}_1}}\\
 {{{\dot x}_2}}
 \end{array}} \right] = \varepsilon \underbrace {\left[ {\begin{array}{*{20}{c}}
 0&1\\
 0&0
 \end{array}} \right]}_A\left[ {\begin{array}{*{20}{c}}
 {{x_1}}\\
 {{x_2}}
 \end{array}} \right] + \underbrace {\left[ {\begin{array}{*{20}{c}}
 0\\
 1
 \end{array}} \right]}_Bu,
\end{gather*}
где пара матриц $ (A,B) $ отвечает, так называемому, <<двойному интегратору>>.
Для этой системы разложение \eqref{s1:gram1} конечно, так как матрица $ A $ нильпотентна ($ A^3 = 0$):
\begin{gather*}
 U_0 = B B^T = \left[ {\begin{array}{*{20}{c}}
 0&0\\
 0&1
 \end{array}}\right],
\end{gather*}
\begin{gather*}
 U_1 = A U_0 + U_0 A^T = \left[ {\begin{array}{*{20}{c}}
 0&1\\
 0&0
 \end{array}}\right] + \left[ {\begin{array}{*{20}{c}}
 0&0\\
 1&0
 \end{array}}\right] = \left[ {\begin{array}{*{20}{c}}
 0&1\\
 1&0
 \end{array}}\right],
\end{gather*}
\begin{gather*}
 U_2 = A U_1 + U_1 A^T = \left[ {\begin{array}{*{20}{c}}
 1&0\\
 0&0
 \end{array}}\right] + \left[ {\begin{array}{*{20}{c}}
 1&0\\
 0&0
 \end{array}}\right] = \left[ {\begin{array}{*{20}{c}}
 2&0\\
 0&0
 \end{array}}\right],
\end{gather*}
\begin{gather*}
 U_3 = U_4 = \dots = 0,
\end{gather*}
\begin{gather*}
 W_{\varepsilon} = U_0 + \dfrac{\varepsilon}{2} U_1 + \dfrac{\varepsilon^2}{6} U_2 = \left[ {\begin{array}{*{20}{c}}
 0&0\\
 0&1
 \end{array}}\right] + \left[ {\begin{array}{*{20}{c}}
 0&\frac{\varepsilon}{2}\\
 \frac{\varepsilon}{2}&0
 \end{array}}\right] +\left[ {\begin{array}{*{20}{c}}
 \frac{\varepsilon^2}{3}&0\\
 0&0
 \end{array}}\right] = 
 \begin{pmatrix}
 \frac{\varepsilon^2}{3}&\frac{\varepsilon}{2}\\
 \frac{\varepsilon}{2}&1
 \end{pmatrix}.
\end{gather*}
 
Собственные числа грамиана управляемости равны
\begin{gather}\label{s1:eigs}
 \lambda_{1,2} = \dfrac{1}{2}+\dfrac{\varepsilon^2}{6} \pm \dfrac{1}{2}\sqrt{\dfrac{\varepsilon^4}{9} + \dfrac{\varepsilon^2}{3} +1}.
\end{gather}
 
Рассмотрим минимальное из них.
Так как $ \varepsilon $ мало, то \eqref{s1:eigs} можно переписать в виде
\begin{gather*}
 \lambda_1 = \dfrac{\varepsilon^2}{12} - \dfrac{\varepsilon^4}{48} + O(\varepsilon^4).
\end{gather*} 
 %Зонтак оптимальное управление
При малых $ \varepsilon $ существуют $\alpha >0 $ такие, что $ \varepsilon^2 > \varepsilon^{3-\alpha} $.
Cледовательно, для системы <<двойной интегратор>>, условие \eqref{s1:small_time_convexity_condition} выполняется, а значит, множества достижимости систем, линеаризация которых вдоль отвечающей нулевому управлению траектории приводит к <<двойному интегратору>>, являются выпуклыми на малых промежутках времени.

\paragraph{Система второго порядка с одним входом.}
Можно показать, что произвольную линейную вполне управляемую систему второго порядка \eqref{s1:eps_linear_system} можно привести к форме Фробениуса с помощью эквивалентных преобразований.
Такие преобразования не меняют асимптотику грамиана управляемости.

Рассмотрим невырожденное преобразование системы \eqref{s1:eps_linear_system}:
\begin{gather}\label{s1:eps_transformed_system}
\begin{gathered}
	\hat{x} = P x, \qquad \hat{A} = P A P^{-1}, \qquad \hat{B} = P B, \\
	\dot{\hat{x}} = \varepsilon \hat{A} \hat{x} + \hat{B} u. 
\end{gathered}
\end{gather}

Покажем, что условие \eqref{s1:small_time_convexity_condition} выполняется для системы \eqref{s1:eps_linear_system} тогда и только тогда, когда оно выполняется для системы \eqref{s1:eps_transformed_system}.
 По аналогии с \eqref{s1:We} выпишем выражения для грамиана управляемости системы \eqref{s1:eps_transformed_system} $\hat{W}_{\varepsilon}$ и коэффициентов разложения $\hat{U_i}$, $i \in \mathbb{N}$:
\begin{gather*}
	\hat{U}_0 = \hat{B} \hat{B}^{\top} = P B B^{\top} P^{\top} = P U_0 P^{\top}.
\end{gather*}

Теперь покажем, что и для $i \geqslant 1$ выполняется равенство $\hat{U}_i = P U_i P^{\top}$.
Действительно,
\begin{gather*}
	\hat{U}_i =
	 \hat{A} \hat{U}_{i-1} + \hat{U}_{i-1} \hat{A}^T = 
	 \left(P A P^{-1} \right) \left( P U_{i-1} P^{\top} \right) + \left( P U_{i-1} P^{\top}\right) \left(P A P^{-1} \right)^{\top} = \\ 
	= P A U_{i-1} P^{\top} + P U_{i-1} A^{\top} P^{\top} = P \left( A U_{i-1} + U_{i-1} A^{\top} \right) P^{\top} = P U_i P^{\top}.
\end{gather*}

Подставляя полученные выражения для $\hat{U}_i$ в \eqref{s1:We}, получим, что грамиан управляемости системы \eqref{s1:eps_transformed_system} связан с грамианом управляемости системы \eqref{s1:eps_linear_system} равенством
\begin{gather*}
	\hat{W}_{\varepsilon} = P W_{\varepsilon} P^{\top}.
\end{gather*}

Отсюда следует, что если $\lambda_{\min}(W_{\varepsilon}) > 0$, то и $\lambda_{\min}(\hat{W}_{\varepsilon}) > 0$ \cite[Теорема 4.5.8]{horn2012}.
Более того, так как $P$ --- невырожденная и квадратная матрица, которая не зависит от $\varepsilon$, то из \cite[Теорема 4.5.10]{horn2012} вытекает, что $a \lambda_{\min}(W_{\varepsilon}) \leqslant \lambda_{\min}(\hat{W}_{\varepsilon}) \leqslant b \lambda_{\min}(W_{\varepsilon})$, причём $a > 0 $, $b > 0$.

Пусть условие \eqref{s1:small_time_convexity_condition} выполнено для системы \eqref{s1:eps_linear_system} с некоторыми $K > 0$, $\alpha > 0$, $\lambda_{\min}(W_{\varepsilon}) \geqslant K \varepsilon^{3-\alpha} $. 
Тогда $\lambda_{\min}(\hat{W}_{\varepsilon}) \geqslant a \lambda_{\min}(W_{\varepsilon}) \geqslant K \varepsilon^{3-\alpha}$.

В обратную сторону, пусть условие \eqref{s1:eps_transformed_system} выполнено для системы \eqref{s1:eps_linear_system} с некоторыми $K > 0$, $\alpha > 0$, $\lambda_{\min}(\hat{W}_{\varepsilon}) \geqslant K \varepsilon^{3-\alpha} $. 
Тогда $ \lambda_{\min}(W_{\varepsilon}) \geqslant \frac{\lambda_{\min}(\hat{W}_{\varepsilon})}{b} \geqslant \frac{K}{b} \varepsilon^{3-\alpha}$.


Поэтому, не теряя общности, будем рассматривать системы вида
 \begin{gather}\label{s1:system32}
 \left[ {\begin{array}{*{20}{c}}
 {{{\dot x}_1}}\\
 {{{\dot x}_2}}
 \end{array}} \right] = \varepsilon \underbrace {\left[ {\begin{array}{*{20}{c}}
 0&1\\
 a_1&a_2
 \end{array}} \right]}_A\left[ {\begin{array}{*{20}{c}}
 {{x_1}}\\
 {{x_2}}
 \end{array}} \right] + \underbrace {\left[ {\begin{array}{*{20}{c}}
 0\\
 1
 \end{array}} \right]}_Bu.
 \end{gather}
 
Применим описанную выше процедуру для поиска коэффициентов разложения \eqref{s1:gram1} грамиана управляемости.
Имеем
\begin{gather*}
 U_0 = B B^T = \left[ {\begin{array}{*{20}{c}}
 0&0\\
 0&1
 \end{array}}\right],
\end{gather*}
\begin{gather*}
 U_1 = A U_0 + U_0 A^T = \left[ {\begin{array}{*{20}{c}}
 0&1\\
 0&a_2
 \end{array}}\right] + \left[ {\begin{array}{*{20}{c}}
 0&0\\
 1&a_2
 \end{array}}\right] = \left[ {\begin{array}{*{20}{c}}
 0&1\\
 1&2 a_2
 \end{array}}\right],
\end{gather*}
\begin{gather*}
 U_2 = A U_1 + U_1 A^T = \left[ {\begin{array}{*{20}{c}}
 1&2a_2\\
 a_2&a_1+2a_2^2
 \end{array}}\right] + \left[ {\begin{array}{*{20}{c}}
 1&a_2\\
 2a_2&a_1+2a_2^2
 \end{array}}\right] = \left[ {\begin{array}{*{20}{c}}
 2&3a_2\\
 3a_2&2a_1+4a_2^2
 \end{array}}\right].
\end{gather*}
 
Подставим найденные коэффициенты в \eqref{s1:gram1} и, заметив, что в последующие слагаемые $ \varepsilon $ входит в степени не ниже $ 3 $, вынесем $ \varepsilon^3 $ за скобки:
\begin{gather}\label{s1:pr32}
\begin{gathered}
 W_{\varepsilon} = U_0 + \dfrac{\varepsilon}{2} U_1 + \dfrac{\varepsilon^2}{6}U_2 + \dots = \left[ {\begin{array}{*{20}{c}}
 0&0\\
 0&1
 \end{array}}\right] +\frac{\varepsilon}{2} \left[ {\begin{array}{*{20}{c}}
 0&1\\
 1&2a_2
 \end{array}}\right] +\frac{\varepsilon^2}{3} \left[ {\begin{array}{*{20}{c}}
 2&3a_2\\
 3a_2&2a_1+4a_2^2
 \end{array}}\right] + \varepsilon^3 \left( \frac{U_3}{24} + \dots \right) =
 \\
 = \underbrace{\left[ \begin{array}{*{20}{c}}
 \frac{\varepsilon^2}{3} & \frac{\varepsilon}{2} + \frac{\varepsilon a_2}{2} \\ 
 \frac{\varepsilon}{2} + \frac{\varepsilon a_2}{2} & \frac{\varepsilon^2}{3}(a_1+2a_2) 
 \end{array} \right]}_{S_{\varepsilon}^{2}} + \underbrace{ \varepsilon^3 \left( \frac{U_3}{24} + \dots \right)}_{R(\varepsilon)}.
\end{gathered}
\end{gather}
 
 
Рассмотрим собственные числа $ \lambda_{\min} $ и $ \lambda_{\max} $ частичной суммы $ S_{\varepsilon}^{2} $ ряда \eqref{s1:pr32}.
Из теоремы Виетта известно, что 
\begin{gather}\label{s1:lambdamax}
 \lambda_{\min} + \lambda_{\max} = \operatorname{tr}(W_{\varepsilon}^{2}) = \left(\frac{2\,{a_{2}}^2}{3}+\frac{a_{1}}{3}+\frac{1}{3}\right)\varepsilon^2+a_{2}\varepsilon+1,
\end{gather}
\begin{gather}\label{s1:lambdamin}
 \lambda_{\min} \lambda_{\max} = \operatorname{det}(W_{\varepsilon}^{2}) = \left(\frac{a_{1}}{9}-\frac{{a_{2}}^2}{36}\right)\varepsilon^4+\left(-\frac{a_{2}}{6}\right)\varepsilon^3+\frac{\varepsilon^2}{12}.
\end{gather}
 
Из предположения об управляемости пары матриц $ (A,B) $ следует положительность собственных чисел $ \lambda_{\min} $ и $ \lambda_{\max} $.
Значит, из \eqref{s1:lambdamax} следует, что при достаточно малых $\varepsilon$
\begin{gather*}
 \lambda_{\max} \leqslant \left(\frac{2\,{a_{2}}^2}{3}+\frac{a_{1}}{3}+\frac{1}{3}\right)\varepsilon^2+a_{2}\varepsilon+1 < 2.
\end{gather*}
Подставляя эту оценку в \eqref{s1:lambdamin}, получим
\begin{gather*}
 \lambda_{\min} = \frac{1}{\lambda_{\max}}\left( \left(\frac{a_{1}}{9}-\frac{{a_{2}}^2}{36}\right)\varepsilon^4+\left(-\frac{a_{2}}{6}\right)\varepsilon^3+\frac{\varepsilon^2}{12}\right).
\end{gather*}
Отсюда следует, что для достаточно малых $\varepsilon$ 
\begin{gather*}
	 \lambda_{\min} \geqslant \frac{\varepsilon^2}{24}.
\end{gather*} 
Минимальное собственное число остаточного члена ряда $ R(\varepsilon) $ содержит $ \varepsilon $ в степенях не менее 3.
 
Для получения нижней границы минимального собственного числа $ \lambda_{\varepsilon} $ грамиана $ W_{\varepsilon}$ воспользуемся свойством суммы собственных значений симметричных матриц\cite{Wilkinson}.
Если к матрице $ M_1 $ добавить матрицу $ M_2 $, то все собственные числа матрицы $ M_1 $ увеличатся не менее, чем на минимальное собственное число матрицы $ M_2 $.
Применяя это свойство к собственным числам частичной суммы и остатка, получим, что найдутся $C > 0$ и $\alpha > 0 $, такие, что
\begin{gather*}
 \lambda_{\varepsilon} \geqslant \lambda_{\min}(S_{\varepsilon}^{2}) + \lambda_{\min}(R(\varepsilon)) \geqslant C \varepsilon^{3-\alpha}.
\end{gather*}
 
Таким образом, нелинейные системы второго порядка с интегральными ограничениями, линеаризация которых приводит к стационарным управляемым системам вида \eqref{s1:system32}, также обладают выпуклыми множествами достижимости на малых промежутках времени.
Примером такой системы является осциллятор Дуффинга, подробно рассмотренный в разделе \ref{s2:examples}.

\paragraph{Система второго порядка с двумя входами и невырожденной матрицей $B$.}
Если матрица $ B $ имеет полный ранг, то $\lambda_{\varepsilon} \geqslant \beta $, где $ \beta $~--- некоторое положительное число, и условие \eqref{s1:small_time_convexity_condition}, очевидно, выполняется.
Интерес же представляет следующий случай.
\paragraph{Система второго порядка с двумя входами и вырожденной матрицей $B$.}
Так как матрица $ B $ вырождена, её столбцы линейно зависимы.
Поэтому систему можно представить в виде
\begin{gather}\label{s1:system4}
 \dot{x} = \varepsilon A x + \left[ \beta \ c\beta \right] {\left[ {\begin{array}{*{20}{c}}
 {{u_1}}\\
 {{u_2}}
 \end{array}} \right]}
\end{gather}
с ограничением
\begin{gather}\label{s1:contrainsts1}
 \int_{0}^{1} \left[ u_1^2 + u_2^2 \right] d \tau \leqslant 1.
\end{gather}
 
Сделав замену управления $ \upsilon = u_1 + c u_2 $, получим систему с одним входом, аналогичную рассмотренной выше:
\begin{gather}\label{s1:system4+}
 \dot{x} = \varepsilon A x + \beta \upsilon, 
\end{gather}
 
Проанализируем изменения ограничений и грамиана управляемости при такой замене.
По определению, грамиан управляемости $ W(t) = \int \limits_0 ^ t e^{\varepsilon A\tau} B B^T e^{\varepsilon A^T\tau} d\tau $.
Рассмотрим грамиан исходной системы: 
\begin{gather*}
 W(1) = \int \limits_0 ^ 1 e^{\varepsilon A\tau} \left[ \begin{array}{cc}
 \beta & c \beta
 \end{array} \right] \left[ \begin{array}{c}
 \beta
 \\ c \beta 
 \end{array} \right] e^{\varepsilon A^T\tau} d\tau = (1 + c^2) \int \limits_0 ^ 1 e^{\varepsilon A\tau} \beta^2 e^{\varepsilon A^T\tau} d\tau = (1 + c^2) \tilde{W}(1),
\end{gather*}
где 
\begin{gather*}
 \tilde{W}(1) = \int \limits_0 ^ 1 e^{\varepsilon A\tau} \beta^2 e^{\varepsilon A^T\tau} d\tau 
\end{gather*}
~--- грамиан системы \eqref{s1:system4+}.
То есть, при описанной выше замене управления, грамиан управляемости умножается на коэффициент $ 1/(1 + c^2)$.
 
 
Покажем, что ограничение на управление $ \upsilon $ можно представить в схожем с исходным ограничением на управление \eqref{s1:contrainsts1} виде
\begin{gather*}
 \int_{0}^{1} \upsilon ^2 d \tau = \int_{0}^{1} \left[ u_1 + c u_2 \right]^2 d \tau = \int_{0}^{1} u^T R u d \tau,
\end{gather*}
где 
\begin{gather*}
 R = \left[ \begin{array}{cc}
 1 & c \\ 
 c & c^2
 \end{array} \right].
\end{gather*}
Воспользуемся оценкой $
u^T R u \leqslant \lambda_{\max}(R) || u ||^2 $, где $ \lambda_{\max}(R) $~--- максимальное собственное число матрицы $ R $, $ \lambda_{\max}(R) = 1 + c^2 $.
Получаем, что
\begin{gather}\label{s1:constraints2}
 \int_{0}^{1} \upsilon ^2 d \tau \leqslant (1 + c^2) \int_{0}^{1} \left[ u_1^2 + u_2^2 \right] d \tau \leqslant (1 + c^2).
\end{gather}

Приведённые выше рассуждения доказывают, что из \eqref{s1:contrainsts1} следует \eqref{s1:constraints2}; обратное тоже верно, так как любое $ \upsilon(t) $, для которого справедливо $ \int_{0}^{1} \upsilon ^2 d \tau \leqslant (1 + c^2) $, можно представить в виде $ \upsilon = u_1 + c u_2 $, где 
\begin{gather*}
 u_1 = \frac{\upsilon}{1+c^2}, \ u_2 = \frac{c \upsilon}{1+c^2}.
\end{gather*}
Тогда $ \int_0^1 \left[ \frac{\upsilon^2}{(1+c^2)^2} + \frac{c^2 \upsilon^2}{(1+c^2)^2}\right] d \tau = \frac{1}{1+c^2} \int_{0}^{1} \upsilon ^2 d \tau \leqslant 1 $. 
 
Таким образом, замена управления $ \upsilon = u_1 + c u_2 $ сводит рассматриваемый случай системы второго порядка с двумя входами и вырожденной матрицей $ B $ к случаю системы второго порядка и одним входом, не изменяя при этом структуру ограничений и грамиана управляемости.
То есть, такие системы также имеют грамиан управляемости, собственные числа которого стремятся к нулю не быстрее $ C \varepsilon^{3-\alpha} $.
Поэтому множества достижимости систем, линеаризация которых приводит к системам вида \eqref{s1:system4}, также выпуклы.

Из рассмотренного выше следует, что системы второго порядка, у которых линеаризованная вдоль траектории, отвечающей нулевому управлению, система стационарна и вполне управляема, обладают выпуклыми множествами достижимости на малых интервалах времени.

\paragraph{Билинейная система.}
Рассмотрим нелинейную систему
\begin{gather}\label{s1:system5}
\begin{gathered}
 \left\{
 \begin{aligned}
 \dot{x}_1 &= x_2 u_1 - x_1 u_2\\
 \dot{x}_2 &= -x_1 u_1 - x_2 u_2
 \end{aligned} \right.
 \\
 x_1(0) = 1, \ x_2(0) = 0
\end{gathered}
\end{gather}
с интегрально-квадратичными ограничением на управление
\begin{gather*}
 \int \limits_0^{\varepsilon} \left( u_1^2 + a^2 u_2^2\right) dt \leqslant \mu^2
\end{gather*} 
на промежутке времени $ \tau \in \left[0;\varepsilon \right] $, где $ \varepsilon > 0 $.
Нулевым управлением $ u_1(t) = u_2(t) \equiv 0 $ порождается траектория $ x_1(t) = 1, x_2(t) = 0 $.
Линеаризовав систему вдоль этой траектории, а также сделав замену управления $ {\tilde u_2} = a u_2 $ и времени $ \tau =\varepsilon t$, получим
\begin{gather}\label{s1:system5l}
 \begin{bmatrix}
 \dot{x}_1\\
 \dot{x}_2
 \end{bmatrix}= \varepsilon 
 \underbrace{\begin{bmatrix}
 0&0\\
 0&0
 \end{bmatrix}}_A 
 \begin{bmatrix}
 x_1\\
 x_2
 \end{bmatrix} 
 + 
 \underbrace{\begin{bmatrix}
 0&-\frac{1}{a}\\
 -1&0
 \end{bmatrix}}_B
 \begin{bmatrix}
 u_1 \\ 
 \tilde{u}_2
 \end{bmatrix}.
\end{gather}
 
Так как система \eqref{s1:system5l} имеет два входа и невырожденную матрицу $ B $, минимальное собственное число грамиана управляемости удовлетворяет условию \eqref{s1:small_time_convexity_condition} и система \eqref{s1:system5} имеет выпуклые множества достижимости на достаточно малых интервалах времени. 
Для того, чтобы построить точные области достижимости системы \eqref{s1:system5}, перепишем уравнения в полярных координатах:
\begin{gather}\label{s1:brokett}
 \left\{ \begin{aligned}
 \dot{r} &= - \frac{1}{a} r \tilde{u_2}\\
 \dot{\varphi} &= - u_1
 \end{aligned} \right.
\end{gather}
с ограничением
\begin{gather*}
 \int \limits_0^{t_1} \left( u_1^2 + \tilde{u}_2^2\right) dt \leqslant \mu^2.
\end{gather*}
Выпишем решение системы \eqref{s1:brokett}:
\begin{gather*}
\begin{aligned}
 r({t_1}) &= {e^{ - \frac{1}{a}\int\limits_0^{{t_1}} {{{\tilde u}_2}} (\tau )d\tau }},\\
 \varphi ({t_1}) &= - \int\limits_0^{{t_1}} {{u_1}} (\tau )d\tau. 
\end{aligned}
\end{gather*}
\begin{figure}[h]
 \begin{minipage}[h]{0.5\linewidth}
 \center{\includegraphics[width=1.05\linewidth]{images/figb11.eps}}
 \end{minipage}
 \hfill
 \begin{minipage}[h]{0.5\linewidth}
 \center{\includegraphics[width=1.05\linewidth]{images/figb21.eps}}
 \end{minipage}
 \caption{Множества достижимости билинейной системы}
 \label{s1:fig:fig31}
\end{figure}
 
Для описания области достижимости системы \eqref{s1:brokett} введём вспомогательную линейную систему
\begin{gather}\label{s1:linearized_systembrokett}
 \begin{bmatrix}
 \dot{y}_1\\
 \dot{y}_2
 \end{bmatrix}
 = 
 \begin{bmatrix}
 0& - 1\\
 1&0
 \end{bmatrix} 
 \begin{bmatrix}
 u_1\\
 u_2
 \end{bmatrix},
\end{gather}
множество достижимости которой является эллипсом $ G(t_1) = \left\lbrace y | y^T \left( B B^T\right) ^{-1} y \leqslant \mu^2 \right\rbrace $, где 
\begin{gather*}
 B = \begin{bmatrix}
 0&{ - 1}\\
 1&0
 \end{bmatrix}.
\end{gather*}
 
Таким образом, множество достижимости системы \eqref{s1:brokett} может быть получено путём нелинейного преобразования множества достижимости $ G(t_1) $ линейной системы \eqref{s1:linearized_systembrokett}
\begin{gather*}
	\begin{aligned}
		r(t_1) &= e^{ \frac{1}{a} y_1}\\
		\varphi (t_1) &= y_2. 
	\end{aligned}
\end{gather*}

На Рисунке \ref{s1:fig:fig31} показаны множества достижимости для различных $ \varepsilon $.
Видно, что при малых значениях $\varepsilon$ множества достижимости выпуклы (правый рисунок), но при увеличении $\varepsilon $ становятся невыпуклыми (левый рисунок).
 % ссылка на тарасьева
\paragraph{Машина Дубинса.} 
Рассмотрим систему 
\begin{gather}\label{s1:system6}
 \left\{ \begin{aligned}
 \dot{x}_1 &= \cos x_3\\
 \dot{x}_2 &= \sin x_3\\
 \dot{x}_3 &= u,
\end{aligned} \right. \qquad x_1(0) = x_2(0) = x_3(0) = 0
\end{gather}
на отрезке $ \left[0, \varepsilon \right] $, где $ \varepsilon > 0 $.
Ограничения на $ u\left(t \right) $ заданы неравенством 
\begin{gather*}%\label{s1:constraints}
 \int_{0}^{\vartheta} u^2(\tau) d\tau \leqslant \mu^2.
\end{gather*}
 
При $ u_1(t) \equiv 0 $ получаем траекторию $ x_1(t) = t, \ x_2(t) = x_3(t) \equiv 0 $.
Как и в предыдущем примере, линеаризуем систему вдоль траектории, порождённой нулевым управлением
\begin{gather}\label{s1:system6l}
 \begin{bmatrix}
 \dot{x}_1\\
 \dot{x}_2\\
 \dot{x}_3
 \end{bmatrix}
 = 
 \varepsilon \underbrace {\begin{bmatrix}
 0&0&0\\
 0&0&1\\
 0&0&0
 \end{bmatrix}}_A
 \begin{bmatrix}
 x_1\\
 x_2 \\
 x_3
 \end{bmatrix}
 + 
 \underbrace {\begin{bmatrix}
 0\\
 0\\
 1
 \end{bmatrix}}_B u.
\end{gather}
\begin{figure}[h]
 \centering
 \includegraphics[width=1\linewidth]{images/fig52.eps}
 \caption{Множество достижимости машины Дубинса для $\varepsilon = 10^{-4}, \mu = 1$.}
 \label{s1:fig:fig3}
\end{figure}
Очевидно, что система \eqref{s1:system6l} неуправляема по 1-ой координате, следовательно, её грамиан управляемости содержит нулевое собственное число, из-за которого условие \eqref{s1:small_time_convexity_condition} не выполняется.
Следовательно, система \eqref{s1:system6} может иметь невыпуклые множества достижимости на малых промежутках времени.
 
Воспользовавшись численным алгоритмом построения множеств достижимости систем с интегральными ограничениями, описанным в Приложении \ref{app:A}, построим множество достижимости \eqref{s1:system6} для $ \mu = 1 $ и $ \varepsilon = 0.0001 $ c (Рис. \ref{s1:fig:fig3}). 
 
Моделирование показывает, что множество достижимости <<машины Дубинса>> $G(\varepsilon)$ невыпукло при достаточно малых $ \varepsilon $.

Покажем аналитически, что $G(\varepsilon)$ не является выпуклым при любом $\varepsilon >0$.
Для этого рассмотрим задачу оптимального управления с линейным терминальным критерием
\begin{gather}\label{s1:opt_problem}
	x_1(\varepsilon) \rightarrow \mathrm{\min}, \qquad
	x(\varepsilon) \in G(\varepsilon).
\end{gather}

Так как множество достижимости замкнуто \cite{GusZykIFAC}, то решение задачи существует. 
Выберем какую-либо оптимальную траекторию и обозначим эту траекторию и порождающее её управление через $x^0(t) $ и $ u^0(t) $, соответственно.

Решение задачи не единственно, так как понятно, что для управления $ \overline{u}(t) = -u^0(t) $ мы будем иметь $ \overline{x}_3(t) = -x_3^0(t), \ \overline{x}_1(t) = x_1^0(t), \ \overline{x}_2(t) = -x_2^0(t) $. 
То есть $ \overline{u}(t) $ --- также оптимальное управление.

Введя дополнительную переменную $ x_4 $ равенством
\begin{gather*}
	\dot{x}_4(t) = u^2(t),
\end{gather*}
задачу \eqref{s1:opt_problem} представим в виде
\begin{gather*}%\label{s1:problem2}
	x_1(\varepsilon) \rightarrow \mathrm{\min}
\end{gather*}
при ограничениях
\begin{gather}\label{s1:system2}
	\left\{
	\begin{aligned}
		\dot{x}_1 &= \cos x_3, \\
		\dot{x}_2 &= \sin x_3, \\
		\dot{x}_3 &= u, \\
		\dot{x}_4 &= u^2
	\end{aligned}
	\right.
	\qquad
	x_i(0) = 0, \quad i = 1, \dots, 4,
	\quad
	{x_4}\left( \varepsilon \right) \le {\mu ^2}.
\end{gather}

Выпишем условие принципа максимума Понтрягина для данной задачи. 
Рассмотрим функцию Понтрягина
$
	H(p,x,u) = p_1 \cos{x_3} + p_2 \sin {x_3} + p_3 u + p_4 u^2
$
и функцию
$
	l(\lambda_0,\lambda_1,x) = \lambda_0 x_1 + \lambda_1 (x_4 - \mu^2).
$
Оптимальное управление $ u^0(t) $ удовлетворяет условию: существуют множители Лагранжа $ \lambda_0 \geq 0 $, $ \lambda_1 \geqslant 0 $, $ (\lambda_0,\lambda_1) \neq 0 $, такие что
\begin{gather*}
	H(p(t),x^0(t),u^0(t))=\max_u H(p(t),x^0(t),u), \quad 0\leqslant t \leqslant \varepsilon,
\end{gather*}
где $ p(t) = \left(p_1(t),p_2(t),p_3(t),p_4(t) \right) $ --- решение сопряжённой системы
\begin{gather*}
		\left\{ \begin{aligned}
						\dot{p}_1 &= -H_{x_1} = 0\\
						\dot{p}_2 &= -H_{x_2} = 0\\
						\dot{p}_3 &= -H_{x_3} = p_1 \sin x_3^0(t) - p_2 \cos x_3^0(t)\\
						\dot{p}_4 &= -H_{x_4} = 0
		\end{aligned} \right.
\end{gather*}
удовлетворяющее условию трансверсальности
$
p(\varepsilon) = -l_x(\lambda_0,\lambda_1, x^0(\varepsilon)) = - (\lambda_0,0,0,\lambda_1).
$
Выполнены также условия дополняющей нежесткости
%\begin{equation*}
$\lambda_1 (x_4^0(\varepsilon) - \mu^2) = 0$.
%\end{equation*}


Из принципа максимума следует, что $H_u(p(t),x^0(t),u^0(t))=0$, и значит \mbox{$2u^0(t)p_4(t)=-p_3(t)$}.
В итоге получаем
\begin{equation*}
		\left\{ \begin{aligned}
						p_1 &= -\lambda_0\\
						p_2 &= 0\\
						\dot{p}_3 &= -\lambda_0 \sin x_3^0(t)\\
						p_4 &= -\lambda_1.
		\end{aligned} \right.
\end{equation*}
Если $ \lambda_1 = 0 $, то максимум $ H $ по $ u $ не достигается, что противоречит принципу максимума. 
Значит $ \lambda_1 \neq 0 $ и, следовательно, $p_4=-\lambda_1 \neq 0$. 
Если $ \lambda_0 = 0 $, то $ p_3(t) \equiv 0 $, и значит $ u^0(t) \equiv 0 $. 
Но при нулевом управлении $ x_3(t) \equiv 0 $, $ \cos x_3 \equiv 1 $, что соответствует максимальному, а не минимальному значению $ x_1(\varepsilon) $.


Таким образом, $ \lambda_0 \neq 0 $, $ u^0(t) = \dfrac{1}{2}\lambda_1^{-1}p_3 $, и пара $ (x_3^0,p_3) $ есть решение краевой задачи.
\begin{gather}\label{s1:boundary}
		\left\{ \begin{aligned}
		& \dot{p}_3 = -\lambda_0 \sin x_3\\
		& \dot{x}_3 = \dfrac{1}{2}\lambda_1^{-1}p_3\\
		& p_3(\varepsilon) = 0 \\
		& x_3(0) = 0.
		\end{aligned} \right.
\end{gather}

Из второго уравнения системы \eqref{s1:system2} получаем
\begin{equation*}
	\int_0^\varepsilon \sin x_3^0(\tau) d\tau = 0.
\end{equation*}

Интегрируя первое из уравнений системы \eqref{s1:boundary}, с учётом равенства $ p_3(\varepsilon) = 0 $ будем иметь $ p_3(0) = 0 $. 
Таким образом, $ p_3(t), x_3^0(t) $ --- решение системы \eqref{s1:boundary} с нулевыми начальными условиями.
В силу теоремы единственности решения дифференциального уравнения имеем $ p_3(t) \equiv 0$, $ x_3^0(t) \equiv 0 $. 
Но $ x_3^0(t) \equiv 0 $ соответствует решению задачи на максимум, а не минимум $ x_1(\varepsilon) $.

Условие $ x_2^0(\varepsilon) \neq 0 $ справедливо для любой оптимальной траектории в задаче \eqref{s1:opt_problem}. 
Выбрав $ \overline{u}(t) = -u^0(t) $, получим другую оптимальную траекторию $ \overline{x}(t) $, для которой $ \overline{x}_2(t) = -x_2^0(t) $, $ \overline{x}_1(t) = x_1^0(t) $.
Рассмотрим точку $ \hat{x} = \dfrac{1}{2}x^0(\varepsilon) + \dfrac{1}{2}\overline{x}(\varepsilon) $, у которой $ \hat{x}_1 = x_1^0(\varepsilon) $, $ \hat{x}_2 = 0 $. 
Покажем, что $ \hat{x} \notin G(\varepsilon) $. 
Действительно, если $ \hat{x} \in G(\varepsilon) $, то найдётся допустимая траектория $ \hat{x}(t) $, такая что $ \hat{x}(\varepsilon) = \hat{x} $. 
Так как $ \hat{x}_1 = \hat{x}_1(\varepsilon) $, то $ \hat{x}(t) $ --- оптимальная траектория. 
Но при этом $ \hat{x}_2(\varepsilon) = 0 $, что противоречит доказанному выше утверждению. 
Таким образом, полусумма точек $ x^0(\varepsilon) $, $ \overline{x}(\varepsilon) \in G(\varepsilon) $ не принадлежит $ G(\varepsilon) $, т.~е. $ G(\varepsilon) $ невыпукла при любом $ \varepsilon > 0 $.




 
\end{document}